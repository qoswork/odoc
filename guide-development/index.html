<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Copyright (c) 2015-2018 The OpenNMS Group, Inc.">
<title>开发者指南</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #212121; padding: 0; margin: 0; font-family: "Roboto", sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.stretch { width: 100%; }

p.lead { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.45; color: #212121; font-weight: 300; margin-top: 0; margin-bottom: 0.25em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #212121; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #4d9c2d; }
a img { border: none; }

#content a { color: #212121; text-decoration: none; border-bottom: 0.75px dashed #212121; line-height: inherit; }
#content a:hover, a:focus { color: #4d9c2d; border-bottom: 0.75px dashed #4d9c2d; }
#content a img { border: none; }

/* Default paragraph styles */
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: "Roboto", sans-serif; font-weight: bold; font-style: normal; color: #444; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.0125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddddd8; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: "Roboto Mono", monospace; font-weight: normal; color: rgba(0, 0, 0, 0.9); }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #212121; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.9375em; color: rgba(0, 0, 0, 0.6); }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: rgba(0, 0, 0, 0.6); }

blockquote, blockquote p { line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #dedede; }
table thead, table tfoot { background: #f7f8f7; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #212121; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #212121; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f7f7f7; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.2; word-spacing: -0.05em; }
h1 strong, h2 strong, h3 strong, #toctitle strong, .sidebarblock > .content > .title strong, h4 strong, h5 strong, h6 strong { font-weight: 400; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: 0.9375em; font-style: normal !important; letter-spacing: 0; padding: 0.1em 0.5ex; word-spacing: -0.15em; background-color: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; line-height: 1.45; text-rendering: optimizeSpeed; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.45; color: rgba(0, 0, 0, 0.9); font-family: "Roboto Mono", "Droid Sans Mono", "DejaVu Sans Mono", "Monospace", monospace; font-weight: normal; text-rendering: optimizeSpeed; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: rgba(51, 51, 51, 0.8); }

kbd { font-family: "Roboto Mono", monospace; display: inline-block; color: #212121; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

p a > code:hover { color: rgba(0, 0, 0, 0.9); }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: rgba(0, 0, 0, 0.85); margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddddd8; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddddd8; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddddd8; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: rgba(0, 0, 0, 0.6); display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: rgba(0, 0, 0, 0.85); }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: rgba(0, 0, 0, 0.85); }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: rgba(0, 0, 0, 0.85); border-bottom: 1px solid #ddddd8; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 1px solid #efefed; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: "Roboto", sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none !important;}
#toc a:active { text-decoration: none; }

#toctitle { color: #444; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #f7f7f7; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #efefed; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #efefed; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: #212121; padding: 1.25em; }

#footer-text { color: rgba(255, 255, 255, 0.8); line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 1px solid #efefed; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #444; text-decoration: none; font-weight: bold;}
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #444;}

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock { background-color: #f7f7f7; }
.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; font-family: "Roboto", Arial, Helvetica, sans-serif; font-size: 1rem; }

table.tableblock.fit-content > caption.title { white-space: nowrap; width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: 1.21875em; line-height: 1.6; color: rgba(0, 0, 0, 0.85); }

table.tableblock #preamble > .sectionbody > [class="paragraph"]:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: "Roboto", sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddddd8; color: rgba(0, 0, 0, 0.6); }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e0e0dc; margin-bottom: 1.25em; padding: 1.25em; background: #f7f7f7; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #444; margin-top: 0; text-align: center; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #f7f7f7; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { -webkit-border-radius: 4px; border-radius: 4px; word-wrap: break-word; padding: 1em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #f7f7f7; background-color: rgba(0, 0, 0, 0.9); }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1em; -webkit-border-radius: 4px; border-radius: 4px; }

.listingblock pre.prettyprint { border-width: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.45; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddddd8; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 1.25em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: rgba(0, 0, 0, 0.85); font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #444; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid rgba(0, 0, 0, 0.6); }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 1.25em 1em; }
.verseblock pre { font-family: "Roboto", sans-serif; font-size: 1.15rem; color: rgba(0, 0, 0, 0.85); font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.9375em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: rgba(0, 0, 0, 0.6); }

.quoteblock.abstract { margin: 0 1em 1.25em 1em; display: block; }
.quoteblock.abstract > .title { margin: 0 0 0.375em 0; font-size: 1.15em; text-align: center; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { word-spacing: 0; line-height: 1.6; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract p:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }

p.tableblock:last-child { margin-bottom: 0; }

td.tableblock > .content { margin-bottom: -1.25em; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #dedede; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot, table.frame-ends { border-width: 1px 0; }

table.stripes-all tr, table.stripes-odd tr:nth-of-type(odd) { background: #f7f7f7; }

table.stripes-none tr, table.stripes-odd tr:nth-of-type(even) { background: none; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.6; background: #f7f8f7; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #212121; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.625em -1.25em; }

ul.inline > li { margin-left: 1.25em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 1.25em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist td:not([class]):first-child { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist td:not([class]):first-child img { max-width: none; }
.colist td:not([class]):last-child { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #3465a4; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; color: #444; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #f57900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #cc0000; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #cc0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: #212121; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Roboto", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

dt, th.tableblock, td.content, div.footnote { text-rendering: optimizeLegibility; }

h1, h2, p, td.content, span.alt { letter-spacing: -0.01em; }

p strong, td.content strong, div.footnote strong { letter-spacing: -0.005em; }

p, blockquote, dt, td.content, span.alt { font-size: 1.0625rem; }

p { margin-bottom: 1.25rem; }

.sidebarblock p, .sidebarblock dt, .sidebarblock td.content, p.tableblock { font-size: 1em; }

.exampleblock > .content { background-color: #fffef7; border-color: #e0e0dc; -webkit-box-shadow: 0 1px 4px #e0e0dc; box-shadow: 0 1px 4px #e0e0dc; }

.print-only { display: none !important; }

@page { margin: 1.25cm 0.75cm; }

@media print { * { -webkit-box-shadow: none !important; box-shadow: none !important; text-shadow: none !important; }
  html { font-size: 80%; }
  a { color: inherit !important; text-decoration: underline !important; }
  a.bare, a[href^="#"], a[href^="mailto:"] { text-decoration: none !important; }
  a[href^="http:"]:not(.bare):after, a[href^="https:"]:not(.bare):after { content: "(" attr(href) ")"; display: inline-block; font-size: 0.875em; padding-left: 0.25em; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  pre, blockquote, tr, img, object, svg { page-break-inside: avoid; }
  thead { display: table-header-group; }
  svg { max-width: 100%; }
  p, blockquote, dt, td.content { font-size: 1em; orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  #toc, .sidebarblock, .exampleblock > .content { background: none !important; }
  #toc { border-bottom: 1px solid #ddddd8 !important; padding-bottom: 0 !important; }
  body.book #header { text-align: center; }
  body.book #header > h1:first-child { border: 0 !important; margin: 2.5em 0 1em 0; }
  body.book #header .details { border: 0 !important; display: block; padding: 0 !important; }
  body.book #header .details span:first-child { margin-left: 0 !important; }
  body.book #header .details br { display: block; }
  body.book #header .details br + span:before { content: none !important; }
  body.book #toc { border: 0 !important; text-align: left !important; padding: 0 !important; margin: 0 !important; }
  body.book #toc, body.book #preamble, body.book h1.sect0, body.book .sect1 > h2 { page-break-before: always; }
  .listingblock code[data-lang]:before { display: block; }
  #footer { padding: 0 0.9375em; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
@media print, amzn-kf8 { #header > h1:first-child { margin-top: 1.25rem; }
  .sect1 { padding: 0 !important; }
  .sect1 + .sect1 { border: 0; }
  #footer { background: none; }
  #footer-text { color: rgba(0, 0, 0, 0.6); font-size: 0.9em; } }
@media amzn-kf8 { #header, #content, #footnotes, #footer { padding: 0; } }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>开发者指南</h1>
<div class="details">
<span id="author" class="author">Copyright (c) 2015-2018 The OpenNMS Group, Inc.</span><br>
<span id="revnumber"> OpenNMS Horizon 23.0.1,</span>
<span id="revdate">Last updated 2018-12-16 09:22:49 CST</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_建立开发系统">1. 建立开发系统</a>
<ul class="sectlevel2">
<li><a href="#_操作系统_环境">1.1. 操作系统 / 环境</a></li>
<li><a href="#_安装">1.2. 安装</a></li>
<li><a href="#_工具">1.3. 工具</a></li>
<li><a href="#_有用的链接">1.4. 有用的链接</a>
<ul class="sectlevel3">
<li><a href="#_opennms_相关">1.4.1. OpenNMS 相关</a></li>
<li><a href="#_安装_设置">1.4.2. 安装 / 设置</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_minion_development">2. Minion development</a>
<ul class="sectlevel2">
<li><a href="#_introduction">2.1. Introduction</a></li>
<li><a href="#_container">2.2. Container</a>
<ul class="sectlevel3">
<li><a href="#_clean_start">2.2.1. Clean Start</a></li>
<li><a href="#_karaf_extender">2.2.2. Karaf Extender</a></li>
</ul>
</li>
<li><a href="#_packaging">2.3. Packaging</a>
<ul class="sectlevel3">
<li><a href="#_adding_a_new_feature_to_the_default_feature_package">2.3.1. Adding a new feature to the default feature package</a></li>
</ul>
</li>
<li><a href="#_guidelines">2.4. Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_security">2.4.1. Security</a></li>
</ul>
</li>
<li><a href="#_testing">2.5. Testing</a>
<ul class="sectlevel3">
<li><a href="#_local_testing">2.5.1. Local Testing</a></li>
<li><a href="#_system_tests">2.5.2. System Tests</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_topology">3. Topology</a>
<ul class="sectlevel2">
<li><a href="#_info_panel_items">3.1. Info Panel Items</a>
<ul class="sectlevel3">
<li><a href="#_programmatic">3.1.1. Programmatic</a></li>
<li><a href="#_scriptable">3.1.2. Scriptable</a></li>
</ul>
</li>
<li><a href="#_graphml">3.2. GraphML</a>
<ul class="sectlevel3">
<li><a href="#_createupdatedelete_graphml_topology">3.2.1. Create/Update/Delete GraphML Topology</a></li>
<li><a href="#_supported_attributes">3.2.2. Supported Attributes</a></li>
<li><a href="#gd-topology-graphml-focus-strategy">3.2.3. Focus Strategies</a></li>
<li><a href="#gd-topology-graphml-icons">3.2.4. Icons</a></li>
<li><a href="#gd-topology-graphml-vertex-status-provider">3.2.5. Vertex Status Provider</a></li>
<li><a href="#gd-topology-graphml-edge-status-provider">3.2.6. Edge Status Provider</a></li>
<li><a href="#gd-topology-graphml-layers">3.2.7. Layers</a></li>
<li><a href="#gd-topology-graphml-breadcrumbs">3.2.8. Breadcrumbs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cors_support">4. CORS Support</a>
<ul class="sectlevel2">
<li><a href="#_为什么需要_cors_支持">4.1. 为什么需要 CORS 支持？</a></li>
<li><a href="#_如何启用_cors_支持">4.2. 如何启用 CORS 支持？</a></li>
<li><a href="#_如何配置_cors_支持">4.3. 如何配置 CORS 支持？</a></li>
</ul>
</li>
<li><a href="#_rest_api">5. ReST API</a>
<ul class="sectlevel2">
<li><a href="#_rest_url">5.1. ReST URL</a></li>
<li><a href="#_认证">5.2. 认证</a></li>
<li><a href="#_数据格式">5.3. 数据格式</a></li>
<li><a href="#_标准参数">5.4. 标准参数</a></li>
<li><a href="#_标准过滤器实例">5.5. 标准过滤器实例</a></li>
<li><a href="#_http_返回码">5.6. HTTP 返回码</a></li>
<li><a href="#_资源标识">5.7. 资源标识</a></li>
<li><a href="#_expose_rest_services_via_osgi">5.8. Expose ReST services via OSGi</a>
<ul class="sectlevel3">
<li><a href="#_define_a_rest_interface">5.8.1. Define a ReST interface</a></li>
<li><a href="#_implement_a_rest_interface">5.8.2. Implement a ReST interface</a></li>
<li><a href="#_export_the_rest_service">5.8.3. Export the ReST service</a></li>
</ul>
</li>
<li><a href="#_currently_implemented_interfaces">5.9. Currently Implemented Interfaces</a>
<ul class="sectlevel3">
<li><a href="#rest-api-acknowledgements">5.9.1. 确认</a></li>
<li><a href="#_告警统计">5.9.2. 告警统计</a></li>
<li><a href="#_告警">5.9.3. 告警</a></li>
<li><a href="#_事件">5.9.4. 事件</a></li>
<li><a href="#_分类">5.9.5. 分类</a></li>
<li><a href="#_flow_api">5.9.6. Flow API</a></li>
<li><a href="#_flow_classification_api">5.9.7. Flow Classification API</a></li>
<li><a href="#_foreign_sources_外部源">5.9.8. Foreign Sources (外部源)</a></li>
<li><a href="#_用户组">5.9.9. 用户组</a></li>
<li><a href="#_heatmap">5.9.10. Heatmap</a></li>
<li><a href="#_接口服务">5.9.11. 接口服务</a></li>
<li><a href="#_自定义报表">5.9.12. 自定义报表</a></li>
<li><a href="#_拓扑图">5.9.13. 拓扑图</a></li>
<li><a href="#_采集量度_api">5.9.14. 采集量度 API</a></li>
<li><a href="#_设备">5.9.15. 设备</a></li>
<li><a href="#_通知">5.9.16. 通知</a></li>
<li><a href="#_故障时间轴">5.9.17. 故障时间轴</a></li>
<li><a href="#_故障">5.9.18. 故障</a></li>
<li><a href="#_requisitions_设备表单">5.9.19. Requisitions (设备表单)</a></li>
<li><a href="#_资源_api">5.9.20. 资源 API</a></li>
<li><a href="#_实时控制台数据">5.9.21. 实时控制台数据</a></li>
<li><a href="#_计划故障">5.9.22. 计划故障</a></li>
<li><a href="#_snmp_配置">5.9.23. SNMP 配置</a></li>
<li><a href="#_用户">5.9.24. 用户</a></li>
<li><a href="#_snmp_trap_北向接口配置">5.9.25. SNMP Trap 北向接口配置</a></li>
<li><a href="#_email_北向接口配置">5.9.26. Email 北向接口配置</a></li>
<li><a href="#_javamail_configuration">5.9.27. Javamail Configuration</a></li>
<li><a href="#_syslog_北向接口配置">5.9.28. Syslog 北向接口配置</a></li>
<li><a href="#_business_service_monitoring">5.9.29. Business Service Monitoring</a></li>
<li><a href="#_设备发现">5.9.30. 设备发现</a></li>
<li><a href="#gs-situation-feedback">5.9.31. Situation Feedback</a></li>
</ul>
</li>
<li><a href="#_rest_api_examples">5.10. ReST API Examples</a>
<ul class="sectlevel3">
<li><a href="#_获得性能图表">5.10.1. 获得性能图表</a></li>
<li><a href="#_provisioning_示例和注释">5.10.2. Provisioning 示例和注释</a></li>
<li><a href="#_debian_lenny_笔记">5.10.3. Debian (Lenny) 笔记</a></li>
<li><a href="#_windows_powershell_rest">5.10.4. Windows Powershell ReST</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_develop_documentation">6. Develop Documentation</a>
<ul class="sectlevel2">
<li><a href="#gd-docs-file-structure">6.1. File Structure in opennms-doc</a></li>
<li><a href="#gd-docs-writing">6.2. Writing</a>
<ul class="sectlevel3">
<li><a href="#gd-docs-conventions">6.2.1. Conventions for text formatting</a></li>
<li><a href="#gd-docs-gotchas">6.2.2. Gotchas</a></li>
</ul>
</li>
<li><a href="#gd-docs-structure">6.3. Headings and document structure</a></li>
<li><a href="#doc-guidelines-links">6.4. Links</a></li>
<li><a href="#doc-guideline-admonitions-notes">6.5. Admonitions and useful notes</a></li>
<li><a href="#gd-docs-attributes">6.6. Attributes</a></li>
<li><a href="#gd-docs-comments">6.7. Comments</a></li>
<li><a href="#gd-docs-tables">6.8. Tables</a></li>
<li><a href="#doc-guidelines-images">6.9. Include images</a></li>
<li><a href="#gd-docs-include-source">6.10. Code Snippets</a>
<ul class="sectlevel3">
<li><a href="#gd-docs-explicit">6.10.1. Explicitly defined in the document</a></li>
<li><a href="#gd-docs-include">6.10.2. Included from an example file</a></li>
<li><a href="#gd-docs-include-parts">6.10.3. Include parts of a file</a></li>
</ul>
</li>
<li><a href="#doc-guidelines-cheat-sheets">6.11. Cheat Sheets and additional hints</a></li>
<li><a href="#gd-docs-migrating-from-wiki">6.12. Migrating content from project wiki</a></li>
</ul>
</li>
<li><a href="#_amqp_integration">7. AMQP Integration</a>
<ul class="sectlevel2">
<li><a href="#_event_forwarder">7.1. Event Forwarder</a>
<ul class="sectlevel3">
<li><a href="#_setup">7.1.1. Setup</a></li>
<li><a href="#_debugging">7.1.2. Debugging</a></li>
</ul>
</li>
<li><a href="#_event_receiver">7.2. Event Receiver</a>
<ul class="sectlevel3">
<li><a href="#_setup_2">7.2.1. Setup</a></li>
<li><a href="#_debugging_2">7.2.2. Debugging</a></li>
</ul>
</li>
<li><a href="#_alarm_northbounder">7.3. Alarm Northbounder</a>
<ul class="sectlevel3">
<li><a href="#_setup_3">7.3.1. Setup</a></li>
<li><a href="#_debugging_3">7.3.2. Debugging</a></li>
</ul>
</li>
<li><a href="#_custom_processors">7.4. Custom Processors</a></li>
</ul>
</li>
<li><a href="#_design_and_styleguidelines">8. Design and Styleguidelines</a>
<ul class="sectlevel2">
<li><a href="#_jasper_report_guideline">8.1. Jasper Report Guideline</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_建立开发系统">1. 建立开发系统</h2>
<div class="sectionbody">
<div class="paragraph">
<p>本指南描述了要开始 OpenNMS 项目开发所必需的要求和步骤。</p>
</div>
<div class="sect2">
<h3 id="_操作系统_环境">1.1. 操作系统 / 环境</h3>
<div class="paragraph">
<p>要 构建/编译 OpenNMS，必须运行 *nix 系统。
不一定非要是物理机，虚拟机就足够了，请酌情选择。
我们建议使用下列系统：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>带有 Cinnamon 桌面环境的 <a href="http://www.linuxmint.com/">Linux Mint</a></p>
</li>
<li>
<p><a href="http://ubuntu.com">Ubuntu 桌面</a></p>
</li>
<li>
<p>Mac OS X</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
本文档建议，你选择一个基于 debian 的桌面环境。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_安装">1.2. 安装</h3>
<div class="paragraph">
<p>下一章描述了要满足预设要求的设置环境。
只要遵循这些操作说明，它们肯能根据操作系统的不同而不同。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell"># 添加 OpenNMS 仓库来安装 icmp，等等
echo "deb http://debian.opennms.org stable main" &gt; /etc/apt/sources.list.d/opennms.list
echo "deb-src http://debian.opennms.org stable main" &gt;&gt; /etc/apt/sources.list.d/opennms.list
# 添加 pgp key
wget -O - https://debian.opennms.org/OPENNMS-GPG-KEY | apt-key add -

# 全部更新
apt-get update

# 安装 stuff
apt-get install -y software-properties-common
apt-get install -y git-core
apt-get install -y nsis

# 安装 Oracle Java 8 JDK
# 此安装基于: http://www.webupd8.org/2014/03/how-to-install-oracle-java-8-in-debian.html
add-apt-repository -y ppa:webupd8team/java
apt-get update
apt-get install -y oracle-java8-installer
apt-get install -y oracle-java8-set-default

# 安装和配置 PostgreSQL
apt-get install -y postgresql
echo "local   all             postgres                                peer" &gt; /etc/postgresql/9.3/main/pg_hba.conf
echo "local   all             all                                     peer" &gt;&gt; /etc/postgresql/9.3/main/pg_hba.conf
echo "host    all             all             127.0.0.1/32            trust" &gt;&gt; /etc/postgresql/9.3/main/pg_hba.conf
echo "host    all             all             ::1/128                 trust" &gt;&gt; /etc/postgresql/9.3/main/pg_hba.conf
# 重新启动 postgres 以应用新配置
/etc/init.d/postgresql restart

# 安装 OpenNMS 基本依赖项
apt-get install -y maven
apt-get install -y jicmp jicmp6
apt-get install -y jrrd

# clone opennms
mkdir -p ~/dev/opennms
git clone https://github.com/OpenNMS/opennms.git ~/dev/opennms</code></pre>
</div>
</div>
<div class="paragraph">
<p>之后，你就可以构建 OpenNMS：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">cd ~/dev/opennms
./clean.pl
./compile.pl -DskipTests
./assemble.pl -p dir</code></pre>
</div>
</div>
<div class="paragraph">
<p>有关如何从源代码构建 OpenNMS 的更多信息，请参考 <a href="http://www.opennms.org/wiki/Installation:Source#Building">从源代码安装</a> 的 wiki。</p>
</div>
<div class="paragraph">
<p>成功构建 OpenNMS 之后，请参考 <a href="http://www.opennms.org/wiki/Installation:Source#Running_OpenNMS">运行 OpenNMS</a> 的 wiki。</p>
</div>
</div>
<div class="sect2">
<h3 id="_工具">1.3. 工具</h3>
<div class="paragraph">
<p>我们建议使用以下工具:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IDE: <a href="https://www.jetbrains.com/idea/">IntelliJ IDEA Ultimate</a></p>
</li>
<li>
<p>DB-Tool: <a href="http://dbeaver.jkiss.org/">DBeaver</a> or <a href="http://www.pgadmin.org/">Postgres Admin - pgAdmin</a></p>
</li>
<li>
<p>Graphing: <a href="http://www.yworks.com/en/products/yfiles/yed/">yEd</a></p>
</li>
<li>
<p>Other: <a href="http://www.atom.io">atom.io</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_有用的链接">1.4. 有用的链接</h3>
<div class="sect3">
<h4 id="_opennms_相关">1.4.1. OpenNMS 相关</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.github.com/OpenNMS/opennms" class="bare">https://www.github.com/OpenNMS/opennms</a>: 托管在 GitHub 上的源代码</p>
</li>
<li>
<p><a href="http://wiki.opennms.org" class="bare">http://wiki.opennms.org</a>: 我们的 Wiki，尤其是开始页面很有趣。它指给你正确的方向。</p>
</li>
<li>
<p><a href="http://issues.opennms.org" class="bare">http://issues.opennms.org</a>: 我们的 issue/bug 跟踪。</p>
</li>
<li>
<p><a href="https://github.com/opennms-forge/vagrant-opennms-dev" class="bare">https://github.com/opennms-forge/vagrant-opennms-dev</a>: 设置 virtual box 来构建 OpenNMS</p>
</li>
<li>
<p><a href="https://github.com/opennms-forge/vagrant-opennms" class="bare">https://github.com/opennms-forge/vagrant-opennms</a>: 设置 virtual box 来运行 OpenNMS</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_安装_设置">1.4.2. 安装 / 设置</h4>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.opennms.eu/docs/opennms-community-welcome-guide/0.0.5-SNAPSHOT/" class="bare">http://www.opennms.eu/docs/opennms-community-welcome-guide/0.0.5-SNAPSHOT/</a></p>
</li>
<li>
<p><a href="http://www.opennms.org/wiki/Installation:Source" class="bare">http://www.opennms.org/wiki/Installation:Source</a></p>
</li>
<li>
<p><a href="http://www.opennms.org/wiki/Developing_with_Git" class="bare">http://www.opennms.org/wiki/Developing_with_Git</a></p>
</li>
<li>
<p><a href="http://www.opennms.org/wiki/Eclipse_and_OpenNMS" class="bare">http://www.opennms.org/wiki/Eclipse_and_OpenNMS</a></p>
</li>
<li>
<p><a href="http://www.opennms.org/wiki/IDEA_and_OpenNMS" class="bare">http://www.opennms.org/wiki/IDEA_and_OpenNMS</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_minion_development">2. Minion development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">2.1. Introduction</h3>
<div class="paragraph">
<p>This guide is intended to help developers get started with writing <em>Minion</em> related features.
It is not intented to be an exhaustive overview of the <em>Minion</em> architecture or feature set.</p>
</div>
</div>
<div class="sect2">
<h3 id="_container">2.2. Container</h3>
<div class="paragraph">
<p>This section details the customizations we make to the standard <em>Karaf</em> distribution for the <em>Minion</em> container.</p>
</div>
<div class="sect3">
<h4 id="_clean_start">2.2.1. Clean Start</h4>
<div class="paragraph">
<p>We clear the cache on every start by setting <code>karaf.clean.cache = true</code> in order to ensure that only the features listed in the featuresBoot (or installed by the <code>karaf-extender</code>) are installed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_karaf_extender">2.2.2. Karaf Extender</h4>
<div class="paragraph">
<p>The <em>Karaf Extender</em> was developed to make it easier to manage and extend the container using existing packaging tools.
It allows packages to register <strong>Maven Repositories</strong>, <strong>Karaf Feature Repositories</strong> and <strong>Karaf Features to Boot</strong> by overlaying additional files, avoiding modifying any of the existing files.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an overview, used for reference, of the relevant directories that are (currently) present on a default install of the <code>opennms-minion</code> package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">├── etc
│   └── featuresBoot.d
│       └── custom.boot
├── repositories
│   ├── .local
│   ├── core
│   │   ├── features.uris
│   │   └── features.boot
│   └── default
│       ├── features.uris
│       └── features.boot
└── system</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the <code>karaf-extender</code> feature is installed it will:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Find all of the folders listed under <code>$karaf.home/repositories</code> that do not start with a '.' and sort these by name.</p>
</li>
<li>
<p>Gather the list of Karaf Feature Repository URIs from the <code>features.uris</code> files in the repositories.</p>
</li>
<li>
<p>Gather the list of Karaf Feature Names from the <code>features.boot</code> files in the repositories.</p>
</li>
<li>
<p>Gather the list of Karaf Feature Names form the files under <code>$karaf.etc/featuresBoot.d</code> that do not start with a '.' and sort these by name.</p>
</li>
<li>
<p>Register the Maven Repositories by updating the <code>org.ops4j.pax.url.mvn.repositories</code> key for the PID <code>org.ops4j.pax.url.mvn</code>.</p>
</li>
<li>
<p>Wait up to 30 seconds until all of the Karaf Feature URIs are resolvable (the Maven Repositiries may take a few moments to update after updating the configuration.)</p>
</li>
<li>
<p>Install the Karaf Feature Repository URIs.</p>
</li>
<li>
<p>Install the Karaf Features.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Features listed in the <code>features.boot</code> files of the Maven Repositiries will take precedence over those listed in <code>featuresBoot.d</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Any existing repository registered in <code>org.ops4j.pax.url.mvn.repositories</code> will be overwritten.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_packaging">2.3. Packaging</h3>
<div class="paragraph">
<p>This sections describes packages for <em>Minion</em> features and helps developers add new features to these packages.</p>
</div>
<div class="paragraph">
<p>We currently provide two different feature packages for <em>Minion</em>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">openns-minion-features-core</dt>
<dd>
<p>Core utilities and services required for connectivity with the <em>OpenNMS</em> controller</p>
</dd>
<dt class="hdlist1">openns-minion-features-default</dt>
<dd>
<p>Minion-specific service extensions</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Every package bundles all of the Karaf Feature Files and Maven Dependencies into a Maven Repository with additional meta-data used by the <code>KarafExtender</code>.</p>
</div>
<div class="sect3">
<h4 id="_adding_a_new_feature_to_the_default_feature_package">2.3.1. Adding a new feature to the default feature package</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the feature definition to <code>container/features/src/main/resources/features-minion.xml</code>.</p>
</li>
<li>
<p>Add the feature name in the <code>features</code> list configuration for the <code>features-maven-plugin</code> in <code>features/minion/repository/pom.xml</code>.</p>
</li>
<li>
<p>Optionally add the feature name to <code>features/minion/repository/src/main/resources/features.boot</code> if the feature should be automatically installed when the container is started.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_guidelines">2.4. Guidelines</h3>
<div class="paragraph">
<p>This sections describes a series of guidelines and best practices when developing <em>Minion</em> modules:</p>
</div>
<div class="sect3">
<h4 id="_security">2.4.1. Security</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Don&#8217;t store any credentials on disk, use the <code>SecureCredentialVault</code> instead.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing">2.5. Testing</h3>
<div class="paragraph">
<p>This sections describes how developers can test features on the <em>Minion</em> container.</p>
</div>
<div class="sect3">
<h4 id="_local_testing">2.5.1. Local Testing</h4>
<div class="paragraph">
<p>You can compile, assemble, and spawn an interactive shell on the <em>Minion</em> container using:</p>
</div>
<div class="listingblock">
<div class="title">Assemble and run the container in place</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">cd features/minion &amp;&amp; ./runInPlace.sh</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_system_tests">2.5.2. System Tests</h4>
<div class="paragraph">
<p>The runtime environment of the <em>Minion</em> container and features differs greatly from those provided by the unit and integration tests.
For this reason, it is important to perform automated end-to-end testing of the features.</p>
</div>
<div class="paragraph">
<p>The system tests provide a framework which allows developers to instantiate a complete Docker-based <em>Minion</em> system using a single <em>JUnit</em> rule.</p>
</div>
<div class="paragraph">
<p>For further details, see the <a href="https://github.com/OpenNMS/minion-system-tests">minion-system-tests</a> project on Github.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_topology">3. Topology</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_info_panel_items">3.1. Info Panel Items</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This section is under development.
All provided examples or code snippet may not fully work.
However they are conceptionally correct and should point in the right direction.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each element in the <em>Info Panel</em> is defined by an <code>InfoPanelItem</code> object.</p>
</div>
<div class="paragraph">
<p>All available <code>InfoPanelItem</code> objects are sorted by the order.
This allows to arrange the items in a custom order.
After the elements are ordered, they are put below the <em>SearchBox</em> and the <em>Vertices in Focus</em> list.</p>
</div>
<div class="sect3">
<h4 id="_programmatic">3.1.1. Programmatic</h4>
<div class="paragraph">
<p>It is possible to add items to the <em>Info Panel</em> in the <em>Topology UI</em> by simply implementing the interface <code>InfoPanelItemProvider</code> and expose its implementation via OSGi.</p>
</div>
<div class="listingblock">
<div class="title">Simple Java InfoPanelItemProvider</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class ExampleInfoPanelItemProvider implements InfoPanelItemProvider {
    @Override
    public Collection&lt;? extends InfoPanelItem&gt; getContributions(GraphContainer container) {
        return Collections.singleton(
                new DefaultInfoPanelItem() <i class="conum" data-value="1"></i><b>(1)</b>
                    .withTitle("Static information") <i class="conum" data-value="2"></i><b>(2)</b>
                    .withOrder(0) <i class="conum" data-value="3"></i><b>(3)</b>
                    .withComponent(
                        new com.vaadin.ui.Label("I am a static component") <i class="conum" data-value="4"></i><b>(4)</b>
                    )
        );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The default implementation of <code>InfoPanelItem</code>.
You may use <code>InfoPanelItem</code> instead if the default implementation is not sufficient.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The title of the <code>InfoPanelItem</code>.
It is shown above the component.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The order.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A Vaadin component which actually describes the custom component.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to show information based on a selected vertex or edge, one must inherit the classes <code>EdgeInfoPanelItemProvider</code> or <code>VertexInfoPanelItemProvider</code>.
The following example shows a custom <code>EdgeInfoPanelItemProvider</code>.</p>
</div>
<div class="listingblock">
<div class="title">Simple Java EdgeInfoPanelItemProvider</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class ExampleEdgeInfoPanelItemProvider extends EdgeInfoPanelItemProvider {
    @Override
    protected boolean contributeTo(EdgeRef ref, GraphContainer graphContainer) { <i class="conum" data-value="1"></i><b>(1)</b>
        return "custom-namespace".equals(ref.getNamespace()); // only show if of certain namespace
    }

    @Override
    protected InfoPanelItem createInfoPanelItem(EdgeRef ref, GraphContainer graphContainer) { <i class="conum" data-value="2"></i><b>(2)</b>
        return new DefaultInfoPanelItem()
                .withTitle(ref.getLabel() + " Info")
                .withOrder(0)
                .withComponent(
                        new com.vaadin.ui.Label("Id: " + ref.getId() + ", Namespace: " + ref.getNamespace())
                );
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Is invoked if one and only one edge is selected.
It determines if the current edge should provide the <em>InfoPanelItem</em> created by <em>createInfoPanelItem</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Is invoked if one and only one edge is selected.
It creates the <em>InfoPanelItem</em> to show for the selected edge.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Implementing the provided interfaces/classes, is not enough to have it show up.
It must also be exposed via a <code>blueprint.xml</code> to the OSGi service registry.
The following <code>blueprint.xml</code> snippet describes how to expose any custom <em>InfoPanelItemProvider</em> implementation to the OSGi service registry and have the <em>Topology UI</em> pick it up.</p>
</div>
<div class="listingblock">
<div class="title">blueprint.xml snippet</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;service interface="org.opennms.features.topology.api.info.InfoPanelItemProvider"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;bean class="ExampleInfoPanelItemProvider" /&gt; <i class="conum" data-value="2"></i><b>(2)</b>
&lt;/service&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The service definition must always point to <em>InfoPanelItemProvider</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The bean implementing the defined interface.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_scriptable">3.1.2. Scriptable</h4>
<div class="paragraph">
<p>By simply dropping JinJava templates (with file extension .html) to <code>$OPENNMS_HOME/etc/infopanel</code> a more scriptable approach is available.
For more information on JinJava refer to <a href="https://github.com/HubSpot/jinjava" class="bare">https://github.com/HubSpot/jinjava</a>.</p>
</div>
<div class="paragraph">
<p>The following example describes a very simple JinJava template which is always visible.</p>
</div>
<div class="listingblock">
<div class="title">Static scriptable template</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">{% set visible = true %}  <i class="conum" data-value="1"></i><b>(1)</b>
{% set title = "Static information" %} <i class="conum" data-value="2"></i><b>(2)</b>
{% set order = -700 %} <i class="conum" data-value="3"></i><b>(3)</b>

This information is always visible <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Makes this always visible</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Defines the title</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Each info panel item is ordered at the end.
Making it -700 makes it very likely to pin this to the top of the info panel item.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A template showing custom information may look as following:</p>
</div>
<div class="listingblock">
<div class="title">Vertex specific template</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">{% set visible = vertex != null &amp;&amp; vertex.namespace == "custom" &amp;&amp; vertex.customProperty is defined %} <i class="conum" data-value="1"></i><b>(1)</b>
{% set title = "Custom Information" %}

&lt;table width="100%" border="0"&gt;
    &lt;tr&gt;
        &lt;td colspan="3"&gt;This information is only visible if a vertex with namespace "custom" is selected&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td align="right" width="80"&gt;Custom Property&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left"&gt;{{ vertex.customProperty }}&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This template is only shown if a vertex is selected and the selected namespace is "custom".</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also possible to show performance data.</p>
</div>
<div class="paragraph">
<div class="title">Including resource graphs</div>
<p>One can include resource graphs into the info panel by using the following HTML element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;div class="graph-container" data-resource-id="RESOURCE_ID" data-graph-name="GRAPH_NAME"&gt;&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optional attributes <code>data-graph-start</code> and <code>data-graph-end</code> can be used to specify the displayed time range in seconds since epoch.</p>
</div>
<div class="listingblock">
<div class="title">Measurements API template (memory usage)</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">{# Example template for a simple memory statistic provided by the netsnmp agent #}
{% set visible = node != null &amp;&amp; node.sysObjectId == ".1.3.6.1.4.1.8072.3.2.10" %}
{% set order = 110 %}

{# Setting the title #}
{% set title = "System Memory" %}

{# Define resource Id to be used #}
{% set resourceId = "node[" + node.id + "].nodeSnmp[]" %}

{# Define attribute Id to be used #}
{% set attributeId = "hrSystemUptime" %}

{% set total = measurements.getLastValue(resourceId, "memTotalReal")/1000/1024 %}
{% set avail = measurements.getLastValue(resourceId, "memAvailReal")/1000/1024 %}

&lt;table border="0" width="100%"&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;Total&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top" colspan="2"&gt;
            {{ total|round(2) }} GB(s)
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;Used&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top" colspan="2"&gt;
            {{ (total-avail)|round(2) }} GB(s)
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;Available&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top" colspan="2"&gt;
            {{ avail|round(2) }} GB(s)
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;Usage&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top"&gt;
            &lt;meter style="width:100%" min="0" max="{{ total }}" low="{{ 0.5*total }}" high="{{ 0.8*total }}" value="{{ total-avail }}" optimum="0"/&gt;
        &lt;/td&gt;
        &lt;td width="1"&gt;
            &amp;nbsp;{{ ((total-avail)/total*100)|round(2) }}%
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Measurements API template (uptime)</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">{# Example template for the system uptime provided by the netsnmp agent #}
{% set visible = node != null &amp;&amp; node.sysObjectId == ".1.3.6.1.4.1.8072.3.2.10" %}
{% set order = 100 %}

{# Setting the title #}
{% set title = "System Uptime" %}

{# Define resource Id to be used #}
{% set resourceId = "node[" + node.id + "].nodeSnmp[]" %}

{# Define attribute Id to be used #}
{% set attributeId = "hrSystemUptime" %}

&lt;table border="0" width="100%"&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;getLastValue()&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top"&gt;
            {# Querying the last value via the getLastValue() method: #}

            {% set last = measurements.getLastValue(resourceId, attributeId)/100.0/60.0/60.0/24.0 %}
            {{ last|round(2) }} day(s)
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;query()&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top"&gt;
            {# Querying the last value via the query() method. A custom function 'currentTimeMillis()' in
            the namespace 'System' is used to get the timestamps for the query: #}

            {% set end = System:currentTimeMillis() %}
            {% set start = end - (15 * 60 * 1000) %}

            {% set values = measurements.query(resourceId, attributeId, start, end, 300000, "AVERAGE") %}

            {# Iterating over the values in reverse order and grab the first value which is not NaN #}
            {% set last = "NaN" %}
            {% for value in values|reverse %}
                {%- if value != "NaN" &amp;&amp; last == "NaN" %}
                    {{ (value/100.0/60.0/60.0/24.0)|round(2) }} day(s)
                    {% set last = value %}
                {% endif %}
            {%- endfor %}
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td width="80" align="right" valign="top"&gt;Graph&lt;/td&gt;
        &lt;td width="14"&gt;&lt;/td&gt;
        &lt;td align="left" valign="top"&gt;
            {# We use the start and end variable here to construct the graph's Url: #}

            &lt;img src="/opennms/graph/graph.png?resourceId=node[{{ node.id }}].nodeSnmp[]&amp;report=netsnmp.hrSystemUptime&amp;start={{ start }}&amp;end={{ end }}&amp;width=170&amp;height=30"/&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_graphml">3.2. GraphML</h3>
<div class="paragraph">
<p>In OpenNMS Horizon the <code>GraphMLTopoloyProvider</code> uses <a href="http://graphml.graphdrawing.org/">GraphML</a> formatted files to visualize graphs.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>GraphML is a comprehensive and easy-to-use file format for graphs.
It consists of a language core to describe the structural properties of a graph and a flexible extension mechanism to add application-specific data.
 [&#8230;&#8203;]
Unlike many other file formats for graphs, GraphML does not use a custom syntax.
Instead, it is based on XML and hence ideally suited as a common denominator for all kinds of services generating, archiving, or processing graphs.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; http://graphml.graphdrawing.org
</div>
</div>
<div class="paragraph">
<p>OpenNMS Horizon does not support the full feature set of GraphML.
The following features are not supported: Nested graphs, Hyperedges, Ports and Extensions.
For more information about GraphML refer to the <a href="http://graphml.graphdrawing.org/primer/graphml-primer.html">Official Documentation</a>.</p>
</div>
<div class="paragraph">
<p>A basic graph definition using GraphML usually consists of the following GraphML elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Graph element to describe the graph</p>
</li>
<li>
<p>Key elements to define custom properties, each element in the GraphML document can define as data elements</p>
</li>
<li>
<p>Node and Edge elements</p>
</li>
<li>
<p>Data elements to define custom properties, which OpenNMS Horizon will then interpret.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A very minimalistic example is given below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;graphml xmlns="http://graphml.graphdrawing.org/xmlns"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns
     http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd"&gt;
     &lt;!-- key section --&gt;
    &lt;key id="label" for="all" attr.name="label" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="namespace" for="graph" attr.name="namespace" attr.type="string"&gt;&lt;/key&gt;

    &lt;!-- shows up in the menu --&gt;
    &lt;data key="label"&gt;Minimalistic GraphML Topology Provider&lt;/data&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;graph id="minicmalistic"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;data key="namespace"&gt;minimalistic&lt;/data&gt; <i class="conum" data-value="3"></i><b>(3)</b>
        &lt;node id="node1"/&gt; <i class="conum" data-value="4"></i><b>(4)</b>
        &lt;node id="node2"/&gt;
        &lt;node id="node3"/&gt;
        &lt;node id="node4"/&gt;
    &lt;/graph&gt;
&lt;/graphml&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The optional label of the menu entry.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The graph definition.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Each graph must have a namespace, otherwise OpenNMS Horizon refuses to load the graph.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Node definitions.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_createupdatedelete_graphml_topology">3.2.1. Create/Update/Delete GraphML Topology</h4>
<div class="paragraph">
<p>In order to create a GraphML Topology, a valid GraphML xml file must exist.
Afterwards this is send to the OpenNMS Horizon REST API to create it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">curl -X POST -H "Content-Type: application/xml" -u admin:admin -d@graph.xml 'http://localhost:8980/opennms/rest/graphml/topology-name'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>topology-name</code> is a unique identifier for the Topology.
If a <code>label</code> property is defined for the Graphml element this is used to be displayed in the Topology UI, otherwise the <code>topology-name</code> defined here is used as a fallback.</p>
</div>
<div class="paragraph">
<p>To delete an already existing Topology a HTTP DELETE request must be send:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-shell" data-lang="shell">curl -X DELETE -u admin:admin 'http://localhost:8980/opennms/rest/graphml/topology-name'</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no PUT method available.
In order to update an existing GraphML Topology one must first delete and afterwards re-create it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Even if the HTTP Request was successful, it does not mean, that the Topology is actually loaded properly.
The HTTP Request states that the Graph was successfully received, persisted and is in a valid GraphML format.
However, the underlying <code>GraphMLTopologyProvider</code> may perform additional checks or encounters problems while parsing the file.
If the Topology does not show up, the <code>karaf.log</code> should be checked for any clues what went wrong.
In addition it may take a while before the Topology is actually selectable from the Topology UI.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_supported_attributes">3.2.2. Supported Attributes</h4>
<div class="paragraph">
<p>A various set of GraphML attributes are supported and interpreted by OpenNMS Horizon while reading the GraphML file.
The following table explains the supported attributes and for which GraphML elements they may be used.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The type of the GraphML-Attribute can be either boolean, int, long, float, double, or string.
These types are defined like the corresponding types in the Java&#8482;-Programming language.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; http://graphml.graphdrawing.org/primer/graphml-primer.html#Attributes
</div>
</div>
<table class="tableblock frame-all grid-all fit-content">
<caption class="title">Table 1. Supported GraphML Attributes</caption>
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">For element</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>namespace</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The namespace must be unique overall existing Topologies.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>description</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description, which is shown in the Info Panel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>preferred-layout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>D3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a preferred layout.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>focus-strategy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FIRST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a focus strategy. See <a href="#gd-topology-graphml-focus-strategy">Focus Strategies</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>focus-ids</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refers to nodes ids in the graph.
                                                                                This is required if <code>focus-strategy</code> is <code>SPECIFIC</code>.
                                                                                If multiple ids should be add to focus, they are separated by <code>,</code>.
                                                                                Example: <code>node1,node2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>semantic-zoom-level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the default SZL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vertex-status-provider</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines which <a href="#gd-topology-graphml-vertex-status-provider">Vertex Status Provider</a> should be used, e.g. <code>default</code>, <code>script</code> or <code>propagate</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iconKey</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>generic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the icon. See <a href="#gd-topology-graphml-icons">Icons</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>label</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph, Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a custom label. If not defined, the <code>id</code> is used instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nodeID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows referencing the Vertex to an OpenNMS node.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foreignSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows referencing the Vertex to an OpenNMS node identified by foreign source and foreign id.
                                                                                Can only be used in combination with <code>foreignID</code>. Please note that this attribute will not be
                                                                                used when the attribute <code>nodeID</code> is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foreignID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows referencing the Vertex to an OpenNMS node identified by foreign source and foreign id.
                                                                                Can only be used in combination with <code>foreignSource</code>. Please note that this attribute will not be
                                                                                used when the attribute <code>nodeID</code> is set.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>tooltipText</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node, Edge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines a custom tooltip. If not defined, the <code>id</code> attribute is used instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the level of the Vertex which is used by certain layout algorithms i.e. <code>Hierarchical Layout</code> and <code>Grid Layout</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>edge-path-offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graph, Node</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls the spacing between the paths drawn for the edges when there are multiple edges connecting two vertices.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>breadcrumb-strategy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GraphML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NONE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the breadcrumb strategy to use. See <a href="#gd-topology-graphml-breadcrumbs">Breadcrumbs</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-focus-strategy">3.2.3. Focus Strategies</h4>
<div class="paragraph">
<p>A <code>Focus Strategy</code> defines which Vertices should be added to focus when selecting the Topology.
The following strategies are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>EMPTY</strong> No Vertex is add to focus.</p>
</li>
<li>
<p><strong>ALL</strong> All Vertices are add to focus.</p>
</li>
<li>
<p><strong>FIRST</strong> The first Vertex is add to focus.</p>
</li>
<li>
<p><strong>SPECIFIC</strong> Only Vertices which id match the graph&#8217;s property <code>focus-ids</code> are added to focus.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-icons">3.2.4. Icons</h4>
<div class="paragraph">
<p>With the <em>GraphMLTopoloygProvider</em> it is not possible to change the icon from the Topology UI.
Instead if a custom icon should be used, each node must contain a <code>iconKey</code> property referencing an SVG element.</p>
</div>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-vertex-status-provider">3.2.5. Vertex Status Provider</h4>
<div class="paragraph">
<p>The <em>Vertex Status Provider</em> calculates the status of the Vertex.
There are multiple implementations available which can be configured for each graph: <code>default</code>, <code>script</code> and <code>propagate</code>.
If none is specified, there is no status provided at all.</p>
</div>
<div class="sect4">
<h5 id="_default_vertex_status_provider">Default Vertex Status Provider</h5>
<div class="paragraph">
<p>The <code>default</code> status provider calculates the status based on the worst unacknowledged alarm associated with the Vertex&#8217;s node.
In order to have a status calculated a (OpenNMS Horizon) node must be associated with the Vertex.
This can be achieved by setting the GraphML attribute <code>nodeID</code> on the GraphML node accordingly.</p>
</div>
</div>
<div class="sect4">
<h5 id="_script_vertex_status_provider">Script Vertex Status Provider</h5>
<div class="paragraph">
<p>The <code>script</code> status provider uses scripts similar to the <a href="#gd-topology-graphml-edge-status-provider">Edge Status Provider</a>.
Just place Groovy scripts (with file extension .groovy) in the directory <code>$OPENNMS_HOME/etc/graphml-vertex-status</code>.
All of the scripts will be evaluated and the most severe status will be used for the vertex in the topology&#8217;s visualization.</p>
</div>
<div class="paragraph">
<p>If the script shouldn&#8217;t contribute any status to a vertex just return <code>null</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_propagate_vertex_status_provider">Propagate Vertex Status Provider</h5>
<div class="paragraph">
<p>The <code>propagate</code> status provider follows all links from a node to its connected nodes.
It uses the status of these nodes to calculate the status by determining the worst one.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-edge-status-provider">3.2.6. Edge Status Provider</h4>
<div class="paragraph">
<p>It is also possible to compute a status for each edge in a given graph.
Just place Groovy scripts (with file extension .groovy) in the directory <code>$OPENNMS_HOME/etc/graphml-edge-status</code>.
All of the scripts will be evaluated and the most severe status will be used for the edge in the topology&#8217;s visualization.</p>
</div>
<div class="paragraph">
<p>The following simple Groovy script example will apply a different style and severity if the edge&#8217;s associated source node is down.</p>
</div>
<div class="listingblock">
<div class="title">Scriptable edge status</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">import org.opennms.netmgt.model.OnmsSeverity;
import org.opennms.features.topology.plugins.topo.graphml.GraphMLEdgeStatus;

if ( sourceNode != null &amp;&amp; sourceNode.isDown() ) {
    return new GraphMLEdgeStatus(OnmsSeverity.WARNING, [ 'stroke-dasharray' : '5,5', 'stroke' : 'yellow', 'stroke-width' : '6' ]);
} else {
    return new GraphMLEdgeStatus(OnmsSeverity.NORMAL, []);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the script shouldn&#8217;t contribute any status to an edge just return <code>null</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-layers">3.2.7. Layers</h4>
<div class="paragraph">
<p>The <em>GraphMLTopologyProvider</em> can handle GraphML files with multiple graphs.
Each Graph is represented as a Layer in the Topology UI.
If a vertex from one graph has an edge pointing to another graph, one can navigate to that layer.</p>
</div>
<div class="listingblock">
<div class="title">GraphML example defining multiple layers</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;graphml xmlns="http://graphml.graphdrawing.org/xmlns"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns
     http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd"&gt;
    &lt;!-- Key section --&gt;
    &lt;key id="label" for="graphml" attr.name="label" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="label" for="graph" attr.name="label" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="label" for="node" attr.name="label" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="description" for="graph" attr.name="description" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="namespace" for="graph" attr.name="namespace" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="preferred-layout" for="graph" attr.name="preferred-layout" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="focus-strategy" for="graph" attr.name="focus-strategy" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="focus-ids" for="graph" attr.name="focus-ids" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="semantic-zoom-level" for="graph" attr.name="semantic-zoom-level" attr.type="int"/&gt;

    &lt;!-- Label for Topology Selection menu --&gt;
    &lt;data key="label"&gt;Layer Example&lt;/data&gt;
    &lt;graph id="regions"&gt;
        &lt;data key="namespace"&gt;acme:regions&lt;/data&gt;
        &lt;data key="label"&gt;Regions&lt;/data&gt;
        &lt;data key="description"&gt;The Regions Layer.&lt;/data&gt;
        &lt;data key="preferred-layout"&gt;Circle Layout&lt;/data&gt;
        &lt;data key="focus-strategy"&gt;ALL&lt;/data&gt;
        &lt;node id="north"&gt;
            &lt;data key="label"&gt;North&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="west"&gt;
            &lt;data key="label"&gt;West&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="south"&gt;
            &lt;data key="label"&gt;South&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="east"&gt;
            &lt;data key="label"&gt;East&lt;/data&gt;
        &lt;/node&gt;
    &lt;/graph&gt;
    &lt;graph id="markets"&gt;
        &lt;data key="namespace"&gt;acme:markets&lt;/data&gt;
        &lt;data key="description"&gt;The Markets Layer.&lt;/data&gt;
        &lt;data key="label"&gt;Markets&lt;/data&gt;
        &lt;data key="description"&gt;The Markets Layer&lt;/data&gt;
        &lt;data key="semantic-zoom-level"&gt;1&lt;/data&gt;
        &lt;data key="focus-strategy"&gt;SPECIFIC&lt;/data&gt;
        &lt;data key="focus-ids"&gt;north.2&lt;/data&gt;
        &lt;node id="north.1"&gt;
            &lt;data key="label"&gt;North 1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="north.2"&gt;
            &lt;data key="label"&gt;North 2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="north.3"&gt;
            &lt;data key="label"&gt;North 3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="north.4"&gt;
            &lt;data key="label"&gt;North 4&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="west.1"&gt;
            &lt;data key="label"&gt;West 1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="west.2"&gt;
            &lt;data key="label"&gt;West 2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="west.3"&gt;
            &lt;data key="label"&gt;West 3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="west.4"&gt;
            &lt;data key="label"&gt;West 4&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="south.1"&gt;
            &lt;data key="label"&gt;South 1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="south.2"&gt;
            &lt;data key="label"&gt;South 2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="south.3"&gt;
            &lt;data key="label"&gt;South 3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="south.4"&gt;
            &lt;data key="label"&gt;South 4&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="east.1"&gt;
            &lt;data key="label"&gt;East 1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="east.2"&gt;
            &lt;data key="label"&gt;East 2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="east.3"&gt;
            &lt;data key="label"&gt;East 3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="east.4"&gt;
            &lt;data key="label"&gt;East 4&lt;/data&gt;
        &lt;/node&gt;
        &lt;!-- Edges in this layer --&gt;
        &lt;edge id="north.1_north.2" source="north.1" target="north.2"/&gt;
        &lt;edge id="north.2_north.3" source="north.2" target="north.3"/&gt;
        &lt;edge id="north.3_north.4" source="north.3" target="north.4"/&gt;
        &lt;edge id="east.1_east.2" source="east.1" target="east.2"/&gt;
        &lt;edge id="east.2_east.3" source="east.2" target="east.3"/&gt;
        &lt;edge id="east.3_east.4" source="east.3" target="east.4"/&gt;
        &lt;edge id="south.1_south.2" source="south.1" target="south.2"/&gt;
        &lt;edge id="south.2_south.3" source="south.2" target="south.3"/&gt;
        &lt;edge id="south.3_south.4" source="south.3" target="south.4"/&gt;
        &lt;edge id="north.1_north.2" source="north.1" target="north.2"/&gt;
        &lt;edge id="north.2_north.3" source="north.2" target="north.3"/&gt;
        &lt;edge id="north.3_north.4" source="north.3" target="north.4"/&gt;

        &lt;!-- Edges to different layers --&gt;
        &lt;edge id="west_north.1" source="north" target="north.1"/&gt;
        &lt;edge id="north_north.2" source="north" target="north.2"/&gt;
        &lt;edge id="north_north.3" source="north" target="north.3"/&gt;
        &lt;edge id="north_north.4" source="north" target="north.4"/&gt;
        &lt;edge id="south_south.1" source="south" target="south.1"/&gt;
        &lt;edge id="south_south.2" source="south" target="south.2"/&gt;
        &lt;edge id="south_south.3" source="south" target="south.3"/&gt;
        &lt;edge id="south_south.4" source="south" target="south.4"/&gt;
        &lt;edge id="east_east.1" source="east" target="east.1"/&gt;
        &lt;edge id="east_east.2" source="east" target="east.2"/&gt;
        &lt;edge id="east_east.3" source="east" target="east.3"/&gt;
        &lt;edge id="east_east.4" source="east" target="east.4"/&gt;
        &lt;edge id="west_west.1" source="west" target="west.1"/&gt;
        &lt;edge id="west_west.2" source="west" target="west.2"/&gt;
        &lt;edge id="west_west.3" source="west" target="west.3"/&gt;
        &lt;edge id="west_west.4" source="west" target="west.4"/&gt;
    &lt;/graph&gt;
&lt;/graphml&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gd-topology-graphml-breadcrumbs">3.2.8. Breadcrumbs</h4>
<div class="paragraph">
<p>When multiple Layers are used it is possible to navigate between them (<code>navigate to</code> option from vertex' context menu).
To give the user some orientation breadcrumbs can be enabled with the <code>breadcrumb-strategy</code> property.</p>
</div>
<div class="paragraph">
<p>The following strategies are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>NONE</strong> No breadcrumbs are shown.</p>
</li>
<li>
<p><strong>SHORTEST_PATH_TO_ROOT</strong> generates breadcrumbs from all visible vertices to the root layer (TopologyProvider).
The algorithms assumes a hierarchical graph. Be aware, that all vertices MUST share the same root layer, otherwise the algorithm to determine the path to root does not work.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure visualizes a graphml defining multiple layers (see below for the graphml definition).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/topology/layers-example.jpg" alt="layers example">
</div>
</div>
<div class="paragraph">
<p>From the given example, the user can select the <code>Breadcrumb Example</code> Topology Provider from the menu.
The user can switch between <code>Layer 1</code>, <code>Layer 2</code> and <code>Layer 3</code>.
In addition for each vertex which has connections to another layer, the user can select the <code>navigate to</code> option from the context menu of that vertex to navigate to the according layer.
The user can also search for all vertices and add it to focus.</p>
</div>
<div class="paragraph">
<p>The following behaviour is implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a user navigates from one vertex to a vertex in another layer, the view is switched to that layer and adds all vertices to focus, the <code>source vertex</code> pointed to. The Breadcrumb is <code>&lt;parent layer name&gt; &gt; &lt;source vertex&gt;</code>.
For example, if a user navigates from <code>Layer1:A2</code> to <code>Layer2:B1</code> the view switches to <code>Layer 2</code> and adds <code>B1</code> and <code>B2</code> to focus. In addition <code>Layer 1 &gt; A2</code> is shown as Breadcrumbs.</p>
</li>
<li>
<p>If a user directly switches to another layer, the default focus strategy is applied, which may result in multiple vertices with no unique parent.
The calculated breadcrumb is: <code>&lt;parent layer name&gt; &gt; Multiple &lt;target layer name&gt;</code>.
For example, if a user switches to <code>Layer 3</code>, all vertices of that layer are added to focus (<code>focus-strategy=ALL</code>). No unique path to root is found, the following breadcrumb is shown instead: <code>Layer 1 &gt; Multiple Layer 1</code> &gt; <code>Multiple Layer 2</code></p>
</li>
<li>
<p>If a user adds a vertex to focus, which is not in the current selected layer, the view switches to that layer and only the "new" vertex is added to focus.
The generated breadcrumb shows the path to root through all layers.
 For example, the user adds <code>C3</code> to focus, and the current layer is <code>Layer 1</code>, than the generated breadcrumb is as follows: <code>Layer 1 &gt; A1 &gt; B3</code>.</p>
</li>
<li>
<p>Only elements between layers are shown in the breadcrumb. Connections on the same layer are ignored.
For example, a user adds <code>C5</code> to focus, the generated breadcrumb is as follows: <code>Layer 1 &gt; A2 &gt; B2</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following graphml file defines the above shown graph.
Be aware, that the root vertex shown above is generated to help calculating the path to root.
It must not be defined in the graphml document.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;graphml xmlns="http://graphml.graphdrawing.org/xmlns"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://graphml.graphdrawing.org/xmlns
     http://graphml.graphdrawing.org/xmlns/1.0/graphml.xsd"&gt;
    &lt;key id="breadcrumb-strategy" for="graphml" attr.name="breadcrumb-strategy" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="label" for="all" attr.name="label" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="description" for="graph" attr.name="description" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="namespace" for="graph" attr.name="namespace" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="focus-strategy" for="graph" attr.name="focus-strategy" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="focus-ids" for="graph" attr.name="focus-ids" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="preferred-layout" for="graph" attr.name="preferred-layout" attr.type="string"&gt;&lt;/key&gt;
    &lt;key id="semantic-zoom-level" for="graph" attr.name="semantic-zoom-level" attr.type="int"/&gt;
    &lt;data key="label"&gt;Breadcrumb Example&lt;/data&gt;
    &lt;data key="breadcrumb-strategy"&gt;SHORTEST_PATH_TO_ROOT&lt;/data&gt;
    &lt;graph id="L1"&gt;
        &lt;data key="label"&gt;Layer 1&lt;/data&gt;
        &lt;data key="namespace"&gt;acme:layer1&lt;/data&gt;
        &lt;data key="focus-strategy"&gt;ALL&lt;/data&gt;
        &lt;data key="preferred-layout"&gt;Circle Layout&lt;/data&gt;
        &lt;node id="a1"&gt;
            &lt;data key="label"&gt;A1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="a2"&gt;
            &lt;data key="label"&gt;A2&lt;/data&gt;
        &lt;/node&gt;
        &lt;edge id="a1_b3" source="a1" target="b3"/&gt;
        &lt;edge id="a1_b4" source="a1" target="b4"/&gt;
        &lt;edge id="a2_b1" source="a2" target="b1"/&gt;
        &lt;edge id="a2_b2" source="a2" target="b2"/&gt;
    &lt;/graph&gt;
    &lt;graph id="L2"&gt;
        &lt;data key="label"&gt;Layer 2&lt;/data&gt;
        &lt;data key="focus-strategy"&gt;ALL&lt;/data&gt;
        &lt;data key="namespace"&gt;acme:layer2&lt;/data&gt;
        &lt;data key="preferred-layout"&gt;Circle Layout&lt;/data&gt;
        &lt;data key="semantic-zoom-level"&gt;0&lt;/data&gt;
        &lt;node id="b1"&gt;
            &lt;data key="label"&gt;B1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="b2"&gt;
            &lt;data key="label"&gt;B2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="b3"&gt;
            &lt;data key="label"&gt;B3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="b4"&gt;
            &lt;data key="label"&gt;B4&lt;/data&gt;
        &lt;/node&gt;
        &lt;edge id="b1_c2" source="b1" target="c2"/&gt;
        &lt;edge id="b2_c1" source="b2" target="c1"/&gt;
        &lt;edge id="b3_c3" source="b3" target="c3"/&gt;
    &lt;/graph&gt;
    &lt;graph id="Layer 3"&gt;
        &lt;data key="label"&gt;Layer 3&lt;/data&gt;
        &lt;data key="focus-strategy"&gt;ALL&lt;/data&gt;
        &lt;data key="description"&gt;Layer 3&lt;/data&gt;
        &lt;data key="namespace"&gt;acme:layer3&lt;/data&gt;
        &lt;data key="preferred-layout"&gt;Grid Layout&lt;/data&gt;
        &lt;data key="semantic-zoom-level"&gt;1&lt;/data&gt;
        &lt;node id="c1"&gt;
            &lt;data key="label"&gt;C1&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="c2"&gt;
            &lt;data key="label"&gt;C2&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="c3"&gt;
            &lt;data key="label"&gt;C3&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="c4"&gt;
            &lt;data key="label"&gt;C4&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="c5"&gt;
            &lt;data key="label"&gt;C5&lt;/data&gt;
        &lt;/node&gt;
        &lt;node id="c6"&gt;
            &lt;data key="label"&gt;C6&lt;/data&gt;
        &lt;/node&gt;
        &lt;edge id="c1_c4" source="c1" target="c4"/&gt;
        &lt;edge id="c1_c5" source="c1" target="c5"/&gt;
        &lt;edge id="c4_c5" source="c4" target="c5"/&gt;
    &lt;/graph&gt;
&lt;/graphml&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cors_support">4. CORS Support</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_为什么需要_cors_支持">4.1. 为什么需要 CORS 支持？</h3>
<div class="paragraph">
<p>默认情况下，许多浏览器实现了一个 <em>same origin policy</em> 策略，防止不同源的资源请求。</p>
</div>
<div class="paragraph">
<p>例如，源于 <a href="http://www.opennms.org" class="bare">http://www.opennms.org</a> 的请求页面包含了 <a href="http://www.adventuresinoss.com" class="bare">http://www.adventuresinoss.com</a> 上的一个资源，被认为是跨源请求。</p>
</div>
<div class="paragraph">
<p>CORS (跨源资源共享) 是用于启用跨源请求的标准机制。</p>
</div>
<div class="paragraph">
<p>有关进一步细节，请参加：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">Mozilla&#8217;s HTTP access control (CORS)</a></p>
</li>
<li>
<p><a href="http://www.w3.org/TR/cors/">W3C&#8217;s CORS Spec</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_如何启用_cors_支持">4.2. 如何启用 CORS 支持？</h3>
<div class="paragraph">
<p>对 REST 接口 (或其它 Web UI 部分) 启用 CORS 支持需要如下步骤：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>打开 '$OPENNMS_HOME/jetty-webapps/opennms/WEB-INF/web.xml' 进行编辑。</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>删除 <strong>&lt;filter-mapping&gt;</strong> 的注释，将 CORS 过滤器应用到 '/rest/' 路径。
修改结果例如：</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">  &lt;!-- Uncomment this to enable CORS support --&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;CORS Filter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/rest/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>重新启动 OpenNMS Horizon</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_如何配置_cors_支持">4.3. 如何配置 CORS 支持？</h3>
<div class="paragraph">
<p>CORS 通过提供的 <strong>org.ebaysf.web.cors.CORSFilter</strong> servlet 过滤器获得支持。</p>
</div>
<div class="paragraph">
<p>可以通过修改上面引用的过滤器定义来配置参数，定义在 'web.xml' 文件中。</p>
</div>
<div class="paragraph">
<p>默认情况下，允许的源参数设置是 '*'。</p>
</div>
<div class="paragraph">
<p>支持的完成参数列表参考：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/ebay/cors-filter" class="bare">https://github.com/ebay/cors-filter</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rest_api">5. ReST API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>RESTful 接口是一个符合 REST 架构风格的 web 服务，正如书中描述 <a href="http://oreilly.com/catalog/9780596529260">RESTful Web Services</a>。
这个页面描述了 <em>OpenNMS Horizon</em> 的 RESTful 接口。</p>
</div>
<div class="sect2">
<h3 id="_rest_url">5.1. ReST URL</h3>
<div class="paragraph">
<p>调用 Rest 的基础 URL 是: <a href="http://opennmsserver:8980/opennms/rest/" class="bare">http://opennmsserver:8980/opennms/rest/</a></p>
</div>
<div class="paragraph">
<p>例如，http://localhost:8980/opennms/rest/alarms/ 将提供系统中的当前告警。</p>
</div>
</div>
<div class="sect2">
<h3 id="_认证">5.2. 认证</h3>
<div class="paragraph">
<p>使用 HTTP 基本身份认证的有效用户名和密码。
默认情况下，你不会收的认证失败信息，因此必须配置你的 ReST 客户端库主动发送基本身份认证信息。</p>
</div>
</div>
<div class="sect2">
<h3 id="_数据格式">5.3. 数据格式</h3>
<div class="paragraph">
<p>Jersey 允许使用 XML 或 JSON 进行 ReST 调用。
默认以 XML 返回 API 的请求。
要获得 JSON 编码的响应，必须发送 header 为: <code>Accept: application/json</code> 的请求。</p>
</div>
</div>
<div class="sect2">
<h3 id="_标准参数">5.4. 标准参数</h3>
<div class="paragraph">
<p>以下是大多数资源上可用的标准参数 (如下所示)</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. ReST 资源标准参数</caption>
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>limit</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数，限制结果的数量。这对事件和通知尤其有用，例如意外调用了没有限制的请求，返回成千上万的结果可能杀死客户端或服务器。如果设置为 0，则不加限制。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>offset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数，是返回结果集的偏移量。例如，如果有100条记录，偏移量是15，并且限制为10，则将返回条目15至24。用于分页。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><strong>过滤</strong>: 被访问实体的所有属性可以被指定为 <em>URL</em> (对于 <em>GET</em>) 或 表单值 (对于 <em>PUT</em> 和 <em>POST</em>) 的参数。像这样可以添加结果过滤器。默认情况下，使用 相等 操作，除非使用 <code>comparator</code> 参数，它适用于 <strong>all</strong> 比较过滤器。多个属性时多个过滤器之间是 <code>AND</code> 操作。可用比较器是：</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>eq</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">相等</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ne</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不相等</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ilike</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不区分大小写的通配符 (<code>%</code> 是通配符)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>like</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">区分大小写的通配符 (<code>%</code> 是通配符)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>gt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">大于</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">小于</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">大于或等于</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>le</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">小于或等于</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>如果给定属性传递 <code>null</code> 值，那么是明确操作 (该属性比较器将忽略)。
<code>notnull</code> 处理类似。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>排序</em>: 如果指定了 <code>orderBy</code> 参数，结果将根据该属性排序。
默认为升序，除非指定 <code>order</code> 参数为 <code>desc</code> (任何其他值将默认为升序)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_标准过滤器实例">5.5. 标准过滤器实例</h3>
<div class="paragraph">
<p>以 <code>/events</code> 为例。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?eventUei=uei.opennms.org/internal/rtc/subscribe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回前10条 rtc subscribe UEI 的事件, (10 是事件的默认限制)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?eventUei=uei.opennms.org/internal/rtc/subscribe&amp;limit=0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回 <strong>所有</strong> 的 rtc subscribe 事件 (可能相当多)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?id=100&amp;comparator=gt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回 ID 大于 100 的前10条事件</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?eventAckTime=notnull</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回确认时间非空的前10条事件 (即，已确认的事件)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?eventAckTime=notnull&amp;id=100&amp;comparator=gt&amp;limit=20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回确认时间非空并且 ID 大于 100 的前20条事件。注意，notnull 值将导致比较器忽略 eventAckTime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?eventAckTime=2008-07-28T04:41:30.530%2B12:00&amp;id=100&amp;comparator=gt&amp;limit=20</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回在 2008年7月28日 上午4:44 (+12:00) 之后确认并且 ID 大于 100 的前20条事件。注意，相同的比较器应用于两个属性比较。还要注意，使用 GET 时，必须对加号进行 URL编码。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?orderBy=id&amp;order=desc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回插入的10条最新事件 (可能的，除非你弄乱了ID)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?location.id=MINION</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将返回 'MINION' 地点的设备相关的前10条事件</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_http_返回码">5.6. HTTP 返回码</h3>
<div class="paragraph">
<p>下面适用于 OpenNMS Horizon 18 及更新版本。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>所有 DELETE 请求成功将返回 204 (NO_CONTENT)。</p>
</li>
<li>
<p>所有 PUT 请求成功将返回 204 (NO_CONTENT)。</p>
</li>
<li>
<p>所有添加或更新实体的 POST 请求成功将返回 204 (NO_CONTENT)。</p>
</li>
<li>
<p>所有相关资源添加的 POST 请求成功将返回 201 (CREATED)。</p>
</li>
<li>
<p>所有返回一个对象的 POST 请求将返回 200 (OK)。</p>
</li>
<li>
<p>除了 申请单和外部源定义 两个之外的所有请都返回 202 (ACCEPTED)。这是因为所有请求实际上都是异步执行的，没办法知道执行状态，或等待处理完成。</p>
</li>
<li>
<p>如果在 PUT 请求期间资源没有修改，将返回 NOT_MODIFIED。成功的情况会返回 NO_CONTENT。</p>
</li>
<li>
<p>所有的成功请求将返回 200 (OK)。</p>
</li>
<li>
<p>对于所有 GET 请求，当一个资源不存在时，就会返回 404 (NOT_FOUND)，但是如果中间资源不存在，则返回 400 (BAD_REQUEST)。例如，如果设备上不存在指定的IP，则返回404。但是如果IP有效而设备无效，因为设备是中间资源，将返回400。</p>
</li>
<li>
<p>如果在处理 HTTP 请求时，从 Service/DAO 层接收到不希望的信息，如异常，将返回 500 (INTERNAL_SERVER_ERROR)。</p>
</li>
<li>
<p>任何传入参数的相关问题，如无效，将产生 400 (BAD_REQUEST)。</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_资源标识">5.7. 资源标识</h3>
<div class="paragraph">
<p>一些端点处理资源，使用 资源 IDs_ 标识。
由于每个资源的父节点基本都是设备，因此构造资源ID的第一步是标识设备资源。
标识设备的资源ID有两种样式：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">样式</th>
<th class="tableblock halign-left valign-top">描述</th>
<th class="tableblock halign-left valign-top">例子</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>node[ID]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过数据ID标识设备，ID是一个整数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>node[42]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>node[FS:FID]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过其外部源名称和外源ID标识一个设备，由冒号连接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>node[Servers:115da833-0957-4471-b496-a731928c27dd]</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>设备标识符后面跟一个句点(.)，然后是资源类型名和实例名。
实例名称的特点可能根据资源类型不同而不同。
举几个例子：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">值</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nodeSnmp[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">设备级 (标量) 设备的性能数据。
                                       此类型是实例标识符为空的唯一类型。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interfaceSnmp[eth0-04013f75f101]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">由 SNMP <code>ifTable</code> 表里的行表示的二层接口。
                                       实例标识符由接口的 <code>ifName</code> 和 <code>ifPhysAddress</code> 组成 (如果有一个)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dskIndex[_root_fs]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">运行 Net-SNMP 管理代理的设备的根文件系统。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>这里有几个很好的资源ID示例:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>node[1].nodeSnmp[]</code></p>
</li>
<li>
<p><code>node[42].interfaceSnmp[eth0-04013f75f101]</code></p>
</li>
<li>
<p><code>node[Servers:115da833-0957-4471-b496-a731928c27dd].dskIndex[_root_fs]</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_expose_rest_services_via_osgi">5.8. Expose ReST services via OSGi</h3>
<div class="paragraph">
<p>In order to expose a ReST service via OSGi the following steps must be followed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define an interface, containing java jax-rs annotations</p>
</li>
<li>
<p>Define a class, implementing that interface</p>
</li>
<li>
<p>Create an OSGi bundle which exports a service with the interface from above</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_define_a_rest_interface">5.8.1. Define a ReST interface</h4>
<div class="paragraph">
<p>At first a public interface must be created which must contain jax-rs annotations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Path("/datachoices") <i class="conum" data-value="1"></i><b>(1)</b>
public interface DataChoiceRestService {

    @POST <i class="conum" data-value="2"></i><b>(2)</b>
    void updateCollectUsageStatisticFlag(@Context HttpServletRequest request, @QueryParam("action") String action);

    @GET
    @Produces(value={MediaType.APPLICATION_JSON})
    UsageStatisticsReportDTO getUsageStatistics();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Each ReST interface must either have a <code>@Path</code> or <code>@Provider</code> annotation.
Otherwise it is not considered a ReST service.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use jax-rs annotations, such as <code>@Post, @GET, @PUT, @Path</code>, etc. to define the ReST service.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_implement_a_rest_interface">5.8.2. Implement a ReST interface</h4>
<div class="paragraph">
<p>A class must implement the ReST interface.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The class may or may not repeat the jax-rs annotations from the interface.
        This is purely for readability.
        Changing or adding different jax-rs annotations on the class, won&#8217;t have any effect.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class DataChoiceRestServiceImpl implements DataChoiceRestService {

    @Override
    public void updateCollectUsageStatisticFlag(HttpServletRequest request, String action) {
       // do something
    }

    @Override
    public UsageStatisticsReportDTO getUsageStatistics() {
       return null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_export_the_rest_service">5.8.3. Export the ReST service</h4>
<div class="paragraph">
<p>At last the ReST service must be exported via the bundlecontext.
This can be either achieved using an Activator or the blueprint mechanism.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	       xsi:schemaLocation="
                http://www.osgi.org/xmlns/blueprint/v1.0.0
                http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
"&gt;
    &lt;bean id="dataChoiceRestService" class="org.opennms.features.datachoices.web.internal.DataChoiceRestServiceImpl" /&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;service interface="org.opennms.features.datachoices.web.DataChoiceRestService" ref="dataChoiceRestService" &gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;service-properties&gt;
            &lt;entry key="application-path" value="/rest" /&gt; <i class="conum" data-value="3"></i><b>(3)</b>
        &lt;/service-properties&gt;
    &lt;/service&gt;

&lt;/blueprint&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create the ReST implementation class</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Export the ReST service</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define where the ReST service will be exported to, e.g. <code>/rest</code>, <code>/api/v2</code>, but also completely different paths can be used.
If not defined, <code>/services</code> is used.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a full working example refer to the <a href="https://github.com/OpenNMS/opennms/tree/develop/features/datachoices">datachoices feature</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_currently_implemented_interfaces">5.9. Currently Implemented Interfaces</h3>
<div class="sect3">
<h4 id="rest-api-acknowledgements">5.9.1. 确认</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
默认偏移量为 0，默认结果限制为 10。
要获得所有结果，使用 <code>limit=0</code> 作为 URL 上的参数 (例如，<code>GET /acks?limit=0</code>)。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_读取数据">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/acks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取确认列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/acks/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取确认的数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em> 格式。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/acks/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的确认信息。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_设置数据">POSTs (设置数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/acks</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">创建或修改给定告警 <em>ID</em> 或通知 <em>ID</em> 的确认。为了表明是告警操作，要在 URL-encoded <em>POST</em> body 中设置一个 <code>alarmId&lt;</code> 参数；为了表明是通知操作，设置 <code>notifyId</code> 代替。还需要一个 <code>action</code> 参数，可选值是 <code>ack</code>，<code>unack</code>，<code>clear</code>，或 <code>esc</code> (升级)。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_curl_使用示例">curl 使用示例</h5>
<div class="listingblock">
<div class="title">确认通知 #3</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u 'admin:admin' -X POST -d notifId=3 -d action=ack http://localhost:8980/opennms/rest/acks</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">升级告警 #42</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u 'admin:admin' -X POST -d alarmId=42 -d action=esc http://localhost:8980/opennms/rest/acks</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_告警统计">5.9.2. 告警统计</h4>
<div class="paragraph">
<p>可以获取告警的一些基本统计数据，包括确认告警数量，总告警数，和最新或最早确认、未确认告警。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_2">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/stats/alarms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回告警相关的统计数据。接受 Hibernate 参数，你可以用在 <code>/alarms</code> ReST 服务上。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/stats/alarms/by-severity</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">返回告警相关的统计数据，每种告警级别的统计。你可以指定 <code>severities</code> 查询参数，并传递告警级别列表来限制统计的级别。(例如 <code>GET /opennms/rest/stats/alarms/by-severity?severities=MAJOR,CRITICAL</code>)。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_告警">5.9.3. 告警</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
默认偏移量为 0，默认结果限制为 10。要获得所有结果，使用 <code>limit=0</code> 作为 URL 上的参数 (例如，<code>GET /alarms?limit=0</code>)。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_3">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取告警列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取告警数量。(返回明文，而不是 <em>XML</em> 或 <em>JSON</em> 格式。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的告警。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>注意，你也可以根据告警级别来查询，例如：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms?comparator=ge&amp;severity=MINOR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取告警级别大于或等于 <em>MINOR</em> 的告警。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms/{id}?ack=''(true;false)''</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">确认 (或取消确认) 告警。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms?x=y&amp;&#8230;&#8203;&amp;ack=''(true;false)''</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">确认 (或取消确认) 告警，并匹配附加查询参数。例如，<code>/alarms?node.id=4&amp;ack=true</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_opennms_1_11_0_版本新特性">OpenNMS 1.11.0 版本新特性</h5>
<div class="paragraph">
<p>在 OpenNMS 1.11.0 中，在告警确认 API 中支持一些附加的特性：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms/{id}?clear=true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">清除告警</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms/{id}?escalate=true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">升级告警。例如，NORMAL &#8594; MINOR，MAJOR &#8594; CRITICAL，等。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms?x=y&amp;&#8230;&#8203;&amp;clear=true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">清除与附加查询参数匹配的告警。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/alarms?x=y&amp;&#8230;&#8203;&amp;escalate=true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">升级与附加查询参数匹配的告警。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>另外，当确认告警时 (ack=true)，你可以指定一个 <code>ackUser</code> 参数。
如果你是一个管理员 <em>admin</em> 角色身份的用户，将允许你进行 <code>ack</code> 操作，作为一个不同的用户。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_事件">5.9.4. 事件</h4>
<div class="sect4">
<h5 id="_gets_读取数据_4">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取事件列表。默认偏移量为 0，默认结果限制为 10。要获得所有结果，使用 <code>limit=0</code> 作为 URL 上的参数 (例如，<code>GET /events?limit=0</code>)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取事件的数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em> 格式。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的事件。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_2">PUTs (修改数据)</h5>
<div class="paragraph">
<p><em>PUT</em> 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events/{id}?ack=''(true;false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">确认 (或取消确认) 某一事件。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events?x=y&amp;&#8230;&#8203;&amp;ack=''(true;false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">确认 (或取消确认) 匹配事件。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要 XML (application/xml) 或 JSON (application/json) 作为 Content-Type。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
请参考 <code>${OPENNMS_HOME}/share/xsds/event.xsd</code> 设计架构。
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将事件发布到事件总线。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_分类">5.9.5. 分类</h4>
<div class="sect4">
<h5 id="_gets_读取数据_5">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有配置的分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定名称的分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}/nodes/{node}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定设备和分类名称的分类 (类似于 <code>/nodes/{node}/categories/{category}</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/nodes/{node}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定设备的分类 (类似于 <code>/nodes/{node}/categories</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/groups/{group}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定用户组的分类 (类似于 <code>/groups/{group}/categories</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_2">POSTs (添加数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加新分类。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_3">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新指定分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}/nodes/{node}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用给定设备ID和名称修改分类 (类似于 <code>/nodes/{node}/categories/{category}</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}/groups/{group}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">将给定的分类添加到指定的用户组 (类似于 <code>/groups/{group}/categories/{category}</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除指定分类</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}/nodes/{node}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从给定设备上删除指定分类 (类似于 <code>/nodes/{node}/categories/{category}</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/categories/{category}/groups/{group}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从给定用户组中删除指定分类 (类似于 <code>/groups/{group}/categories/{category}</code>)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_flow_api">5.9.6. Flow API</h4>
<div class="paragraph">
<p>The <em>Flow API</em> can be used to retrieve summary statistics and time series data derived from persisted flows.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unless specific otherwise, all unit of time are expressed in milliseconds.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_reading_data">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the number of flows available</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/exporters</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve basic information for the exporter nodes that have flows available</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/exporters/{nodeCriteria}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve detailed information about a specific exporter node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/applications</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve traffic summary statistics for the top N applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/applications/series</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve time series metrics for the top N applications</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/conversations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve traffic summary statistics for the top N conversations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/flows/conversations/series</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve time series metrics for the top N conversations</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All of the endpoints support the following query string parameters to help filter the results:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The given filters are combined using a logical <code>AND</code>.
There is no support for using <code>OR</code> logic, or combinations thereof.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-14400000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timestamp in milliseconds.</p>
<p class="tableblock">                                   If &gt; 0, the timestamp is relative to the UNIX epoch (January 1st 1970 00:00:00 AM).</p>
<p class="tableblock">                                   If &lt; 0, the timestamp is relative to the <code>end</code> option (i.e.: default value is 4 hours ago).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Timestamp in milliseconds. If &lt;= 0, the effective value will be the current timestamp.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ifIndex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter for flows that came in through the given SNMP interface.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exporterNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter for flows that came where exported by the given node.</p>
<p class="tableblock">                                   Support either node id (integer) i.e. 1, or foreign source and foreign id lookups i.e. FS:FID.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>exporters</code> endpoints do not support any parameters.</p>
</div>
<div class="paragraph">
<p>The <code>applications</code> endpoints also support:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of top entries (determined by total bytes transferred) to return</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">includeOther</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When set to <code>true</code> the results will also include an additional row or column that contains
                                   the bytes transferred for the flows that fall outside of the Top N.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>applications</code> and <code>conversations</code> endpoints also support:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of top entries (determined by total bytes transferred) to return</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>series</code> endpoints also support:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
<th class="tableblock halign-left valign-top">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requested time interval between rows.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_examples">Examples</h6>
<div class="listingblock">
<div class="title">Retrieve the number of flows persisted in the last 4 hours</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin http://localhost:8980/opennms/rest/flows/count</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">915</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve traffic summary for top 10 applications in the last 4 hours</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin http://localhost:8980/opennms/rest/flows/applications</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
	"start": 1513788044417,
	"end": 1513802444417,
	"headers": ["Application", "Bytes In", "Bytes Out"],
	"rows": [
		["https", 48789, 136626],
		["http", 12430, 5265]
	]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve traffic summary for top 10 conversations in the last 4 hours</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin http://localhost:8980/opennms/rest/flows/conversations</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
	"start": 1513788228224,
	"end": 1513802628224,
	"headers": ["Location", "Protocol", "Source IP", "Source Port", "Dest. IP", "Dest. Port", "Bytes In", "Bytes Out"],
	"rows": [
		["Default", 17, "10.0.2.15", 33816, "172.217.0.66", 443, 12166, 117297],
		["Default", 17, "10.0.2.15", 32966, "172.217.0.70", 443, 5042, 107542],
		["Default", 17, "10.0.2.15", 54087, "172.217.0.67", 443, 55393, 5781],
		["Default", 17, "10.0.2.15", 58046, "172.217.0.70", 443, 4284, 46986],
		["Default", 6, "10.0.2.15", 39300, "69.172.216.58", 80, 969, 48178],
		["Default", 17, "10.0.2.15", 48691, "64.233.176.154", 443, 8187, 39847],
		["Default", 17, "10.0.2.15", 39933, "172.217.0.65", 443, 1158, 33913],
		["Default", 17, "10.0.2.15", 60751, "216.58.218.4", 443, 5504, 24957],
		["Default", 17, "10.0.2.15", 51972, "172.217.0.65", 443, 2666, 22556],
		["Default", 6, "10.0.2.15", 46644, "31.13.65.7", 443, 459, 16952]
	]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve time series data for top 3 applications in the last 4 hours</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin http://localhost:8980/opennms/rest/flows/applications/series?N=3&amp;includeOther=true&amp;step=3600000</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "start": 1516292071742,
    "end": 1516306471742,
    "columns": [
        {
            "label": "domain",
            "ingress": true
        },
        {
            "label": "https",
            "ingress": true
        },
        {
            "label": "http",
            "ingress": true
        },
        {
            "label": "Other",
            "ingress": true
        }
    ],
    "timestamps": [
        1516291200000,
        1516294800000,
        1516298400000
    ],
    "values": [
        [9725, 12962, 9725],
        [70665, 125044, 70585],
        [10937,13141,10929],
        [1976,2508,2615]
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve time series data for top 3 conversations in the last 4 hours</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin http://localhost:8980/opennms/rest/flows/conversations/series?N=3&amp;step=3600000</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "start": 1516292150407,
    "end": 1516306550407,
    "columns": [
        {
            "label": "10.0.2.15:55056 &lt;-&gt; 152.19.134.142:443",
            "ingress": false
        },
        {
            "label": "10.0.2.15:55056 &lt;-&gt; 152.19.134.142:443",
            "ingress": true
        },
        {
            "label": "10.0.2.15:55058 &lt;-&gt; 152.19.134.142:443",
            "ingress": false
        },
        {
            "label": "10.0.2.15:55058 &lt;-&gt; 152.19.134.142:443",
            "ingress": true
        },
        {
            "label": "10.0.2.2:61470 &lt;-&gt; 10.0.2.15:8980",
            "ingress": false
        },
        {
            "label": "10.0.2.2:61470 &lt;-&gt; 10.0.2.15:8980",
            "ingress": true
        }
    ],
    "timestamps": [
        1516294800000,
        1516298400000
    ],
    "values": [
        [17116,"NaN"],
        [1426,"NaN"],
        [20395,"NaN",
        [1455,"NaN"],
        ["NaN",5917],
        ["NaN",2739]
    ]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_flow_classification_api">5.9.7. Flow Classification API</h4>
<div class="paragraph">
<p>The <em>Flow Classification API</em> can be used to update, create or delete flow classification rules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If not otherwise specified the <code>Content-Type</code> of the response is <code>application/json</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_reading_data_2">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve a list of all enabled rules.
  The request is limited to <code>10</code> items by default.
  Setting <code>limit</code> to <code>0</code> returns ALL enabled rules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the rule identified by <code>{id}</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve all existing groups.
  The request is limited to <code>10</code> items by default.
  Setting <code>limit</code> to <code>0</code> returns ALL enabled rules.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/groups/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the group identified by <code>{id}`</code>
  Supports downloading all rules of the given group in CSV format.
  For this, set the accept header: <code>Accept: text/comma-separated-values</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/protocols</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve all supported tcp protocols.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>/classifications</code> endpoint supports the following url parameters:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The given filters are combined using a logical <code>AND</code>.
 There is no support for using <code>OR</code> logic, or combinations thereof.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupFilter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The group to filter the rules by. Should be the <code>id</code> retrieved by <code>/classifications/groups</code>.
  It is not possible to retrieve the rules for a disabled group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_examples_2">Examples</h6>
<div class="listingblock">
<div class="title">Retrieve all enabled rules</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X GET -u admin:admin http://localhost:8980/opennms/rest/classifications</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">[
    {
        "group": {
            "description": "Classification rules defined by the user",
            "enabled": true,
            "id": 2,
            "name": "user-defined",
            "priority": 10,
            "readOnly": false,
            "ruleCount": 1
        },
        "id": 1,
        "ipAddress": null,
        "name": "http",
        "port": "80",
        "position": 0,
        "protocols": [
            "TCP"
        ]
    }
]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve all groups</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X GET -u admin:admin http://localhost:8980/opennms/rest/classifications/groups</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">[
    {
        "description": "Classification rules defined by OpenNMS",
        "enabled": false,
        "id": 1,
        "name": "pre-defined",
        "priority": 0,
        "readOnly": true,
        "ruleCount": 6248
    },
    {
        "description": "Classification rules defined by the user",
        "enabled": true,
        "id": 2,
        "name": "user-defined",
        "priority": 10,
        "readOnly": false,
        "ruleCount": 1
    }
]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve specific rule</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X GET -u admin:admin http://localhost:8980/opennms/rest/classifications/1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "group": {
        "description": "Classification rules defined by the user",
        "enabled": true,
        "id": 2,
        "name": "user-defined",
        "priority": 10,
        "readOnly": false,
        "ruleCount": 1
    },
    "id": 1,
    "ipAddress": null,
    "name": "http",
    "port": "80",
    "position": 0,
    "protocols": [
        "TCP"
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve specific group</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X GET -H "Accept: application/json"  -u admin:admin http://localhost:8980/opennms/rest/classifications/groups/1</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "description": "Classification rules defined by OpenNMS",
    "enabled": false,
    "id": 1,
    "name": "pre-defined",
    "priority": 0,
    "readOnly": true,
    "ruleCount": 6248
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve group as CSV</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X GET -H "Accept: text/comma-separated-values" -u admin:admin http://localhost:8980/opennms/rest/classifications/groups/2</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-text" data-lang="text">name;ipAddress;port;protocol
http;;80;TCP</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_posts_creating_data">POSTs (Creating Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Post a new rule or import rules from CSV.
  If multiple rules are imported (to user-defined group) from a CSV file all existing rules are deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/classify</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Classify the given request based on all enabled rules.</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_examples_3">Examples</h6>
<div class="listingblock">
<div class="title">Create a single rule</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST -H "Content-Type: application/json" -u admin:admin -d '{"name": "http", "port":"80,8080", "protocols":["tcp", "udp"]}' http://localhost:8980/opennms/rest/classifications</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-text" data-lang="text">HTTP/1.1 201 Created
Date: Thu, 08 Feb 2018 14:44:27 GMT
Location: http://localhost:8980/opennms/rest/classifications/6616</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify classification engine (rule exists)</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST -H "Content-Type: application/json" -u admin:admin -d '{"protocol": "tcp", "ipAddress": "192.168.0.1", "port" :"80"}' http://localhost:8980/opennms/rest/classifications/classify</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
  "classification":"http"
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Verify classification engine (no rule exists)</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST -H "Content-Type: application/json" -u admin:admin -d '{"protocol": "tcp", "ipAddress": "192.168.0.1", "port" :"8980"}' http://localhost:8980/opennms/rest/classifications/classify</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Import rules from CSV</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST -H "Content-Type: text/comma-separated-values" -u admin:admin -d $'name;ipAddress;port;protocol\nOpenNMS;;8980;tcp,udp\n' http://localhost:8980/opennms/rest/classifications\?hasHeader\=true</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">HTTP/1.1 204 No Content</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Import rules from CSV (data with errors)</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST -H "Content-Type: text/comma-separated-values" -u admin:admin -d $'OpenNMS;;INCORRECT;tcp,udp\nhttp;;80,8080;ULF' http://localhost:8980/opennms/rest/classifications\?hasHeader\=false</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "errors": {
        "1": {
            "context": "port",
            "key": "rule.port.definition.invalid",
            "message": "Please provide a valid port definition. Allowed values are numbers between 0 and 65536. A range can be provided, e.g. \"4000-5000\", multiple values are allowed, e.g. \"80,8080\""
        },
        "2": {
            "context": "protocol",
            "key": "rule.protocol.doesnotexist",
            "message": "The defined protocol 'ULF' does not exist"
        }
    },
    "success": false
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_puts_updating_data">PUTs (Updating Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update a rule identified by <code>{id}</code>.
  The id of the rule cannot be changed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retrieve the rule identified by <code>{id}</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications/groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update a group.
  At the moment, only the enabled property can be changed</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_deleting_data">DELETEs (Deleting Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/classifications?groupId={groupId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes all rules of a given group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete the given group and all it&#8217;s containing rules.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_foreign_sources_外部源">5.9.8. Foreign Sources (外部源)</h4>
<div class="paragraph">
<p>OpenNMS Horizon 的 ReSTful 服务 Provisioning 外部源定义。外部源定义用于控制 SLA 监控的服务扫描 (服务探测)，以及物理接口 (资源) 的数据采集设置。</p>
</div>
<div class="paragraph">
<p>这个 API 支持 CRUD 操作来管理 Provisioner 的外部源定义。外部源定义被 POSTed，并且当 Provisiond 导入/同步相应的申请单时，将被部署。</p>
</div>
<div class="paragraph">
<p>如果一个请求得到了 "active" 状态的外部源，那意味着它返回就绪的外部源 (被编辑部署)，否则它将返回部署的外部源。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_6">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有激活的外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/default</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取激活默认外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/deployed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有已部署 (active) 外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/deployed/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取部署的外部源的数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em> 格式。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取名为 {name} 的激活外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/detectors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取外部源名为 {name} 的配置探测器。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/detectors/{detector}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取名为 {name} 的外部源指定的探测器。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/policies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取外部源名为 {name} 的配置策略。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/policies/{policy}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取外部源名为 {name} 的指定策略。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_3">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要 XML (application/xml) 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/detectors</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向指定名称的外部源添加探测器。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/policies</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向指定名称的外部源添加策略。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_4">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">修改给定名称的外部源。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_2">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除给定名称的外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/detectors/{detector}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从给定名称的外部源删除指定探测器。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/foreignSources/{name}/policies/{policy}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从给定名称的外部源删除指定策略。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_用户组">5.9.9. 用户组</h4>
<div class="paragraph">
<p>和用户一样，用户组也有一个简单的接口。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_7">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取组列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定名称的用户组。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/users</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取指定组的所有用户。(OpenNMS 14 版本新特性)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定组名称，获取与组关联的分类。 (OpenNMS 14 版本新特性)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_4">POSTs (添加数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加一个新组。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_5">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新组的元数据 (例如，更改 <code>comments</code> 字段)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/users/{username}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定组名和用户名，向组添加用户。 (OpenNMS 14 版本新特性)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/categories/{categoryname}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定组名和分类名，将分类与组关联。 (OpenNMS 14 版本新特性)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_3">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除一个组。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/users/{username}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从组中删除用户。 (OpenNMS 14 版本新特性)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/groups/{groupname}/categories/{categoryname}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定组名和分类名，将分类与组分离。 (OpenNMS 14 版本新特性)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_heatmap">5.9.10. Heatmap</h4>
<div class="sect4">
<h5 id="_gets_reading_data_3">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes grouped by <em>Surveillance Categories</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/foreignSources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes grouped by <em>Foreign Source</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/monitoredServices</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes grouped by monitored services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/nodesByCategory/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes associated with a specific <em>Surveillance Category</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/nodesByForeignSource/{foreignSource}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes associated with a specific <em>Foreign Source</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/outages/nodesByMonitoredService/{monitoredService}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on outages for nodes providing a specific monitored service</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes grouped by <em>Surveillance Categories</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/foreignSources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes grouped by <em>Foreign Source</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/monitoredServices</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes grouped by monitored services</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/nodesByCategory/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes associated with a specific <em>Surveillance Category</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/nodesByForeignSource/{foreignSource}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes associated with a specific <em>Foreign Source</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/heatmap/alarms/nodesByMonitoredService/{monitoredService}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sizes and color codes based on alarms for nodes providing a specific monitored service</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_接口服务">5.9.11. 接口服务</h4>
<div class="paragraph">
<p>基于给定的搜索规则获取或修改监控服务的状态，基于设备，IP接口，分类，或监控服务。</p>
</div>
<div class="paragraph">
<p>实例:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>/ifservices?node.label=onms-prd-01</p>
</li>
<li>
<p>/ifservices?ipInterface.ipAddress=192.168.32.140</p>
</li>
<li>
<p>/ifservices?category.name=Production</p>
</li>
<li>
<p>/ifservices?status=A</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_8">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ifservices</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定搜索规则匹配的所有配置监控服务。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>实例:</p>
</div>
<div class="paragraph">
<p>获取申请单名为 <em>Servers</em> 的设备强制未管理服务：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://localhost:8980/opennms/rest/ifservices?status=F&amp;node.foreignSource=Servers"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_6">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ifservices/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新给定搜索规则匹配的所有配置监控服务。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>实例:</p>
</div>
<div class="paragraph">
<p>标记属于分类 <em>Production</em> 的设备上的 <em>ICMP</em> 和 <em>HTTP</em> 服务为强制未管理:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin -X PUT "status=F&amp;services=ICMP,HTTP" "http://localhost:8980/opennms/rest/ifservices?category.name=Production"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_自定义报表">5.9.12. 自定义报表</h4>
<div class="sect4">
<h5 id="_gets_读取数据_9">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ksc</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有自定义报表的列表，包括 ID 和标签。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ksc/{reportId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过ID获取指定自定义报表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ksc/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有自定义报表的数量。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_7">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/ksc/{reportId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">修改给定ID的报表。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_创建数据">POSTs (创建数据)</h5>
<div class="paragraph">
<p>文档不完整，参见问题: <a href="http://issues.opennms.org/browse/NMS-7162">NMS-7162</a></p>
</div>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_4">DELETEs (删除数据)</h5>
<div class="paragraph">
<p>文档不完整，参见问题: <a href="http://issues.opennms.org/browse/NMS-7162">NMS-7162</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_拓扑图">5.9.13. 拓扑图</h4>
<div class="paragraph">
<p><em>SVG 拓扑图</em> 使用 <em>ReST</em> 填充数据。
这就是这个接口要做的。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_10">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取拓扑图列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的拓扑图。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps/{id}/mapElements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的拓扑图元素 (<em>节点</em>, <em>链接</em>, <em>等</em>.)。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_5">POSTs (添加数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加拓扑图。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_8">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新给定 <em>ID</em> 的拓扑图属性。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_5">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/maps/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除给定 <em>ID</em> 的拓扑图。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_采集量度_api">5.9.14. 采集量度 API</h4>
<div class="paragraph">
<p><em>指标量度 API</em> 可以用来检索存储在 <em>RRD</em> (或 <em>JRB</em>) 文件和 <em>Newts</em> 中的采集值。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
除非另有说明，所有时间单位为毫秒。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_11">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/measurements/{resourceId}/{attribute}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">检索单个属性的指标度量值</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>下表显示所有支持的查询字符串参数及其默认值。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名称</th>
<th class="tableblock halign-left valign-top">默认值</th>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-14400000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">时间戳以毫秒为单位。</p>
<p class="tableblock">                                   如果大于 0， 时间戳相对于 UNIX epoch (January 1st 1970 00:00:00 AM)。</p>
<p class="tableblock">                                   如果小于 0， 时间戳与 <code>end</code> 选项相对应 (即: 默认值是 4 小时前)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">时间戳以毫秒为单位。如果 &lt;= 0，有效值将是当前时间戳。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">300000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">请求行之间的时间间隔。实际步长可能有所不同。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxrows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">当用指标度量值来生成图形时，这应该被设置为图形的像素宽度。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aggregation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AVERAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用的计算函数。通常可以是 <code>AVERAGE</code>, <code>MIN</code> 或 <code>MAX</code>。 取决于 <code>RRA</code> 定义。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fallback-attribute</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">次要属性，在主属性不存在的情况下将被查询。</p></td>
</tr>
</tbody>
</table>
<div class="sect5">
<h6 id="_步长">步长</h6>
<div class="paragraph">
<p><code>step</code> 参数的特性基于正在使用的时间序列策略。</p>
</div>
<div class="paragraph">
<p>当使用基于 <em>RRD</em> 的存储策略时， 可用步长大小仅限于创建文件时，由 <em>RRA</em> 定义的那些。
所使用的有效步长将是跨越请求周期的一个，并且最接近所请求的步长。
为了达到最大的精度，使用1作为步长。</p>
</div>
<div class="paragraph">
<p>当使用 <em>Newts</em> 时，由于在请求时执行聚合，所以可以任意设置步长。
为了帮助防止大的请求，我们限制了最小5分钟的步长，默认的采集速率。
通过设置 <code>org.opennms.newts.query.minimum_step</code> 系统属性，可以降低该值。</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_基于curl使用实例">基于curl使用实例</h5>
<div class="listingblock">
<div class="title">为节点1检索过去2小时的 CPU 指标度量值</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://127.0.0.1:8980/opennms/rest/measurements/node%5B1%5D.nodeSnmp%5B%5D/CpuRawUser?start=-7200000&amp;maxrows=30&amp;aggregation=AVERAGE"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;query-response end="1425588138256" start="1425580938256" step="300000"&gt;
  &lt;columns&gt;
    &lt;values&gt;159.5957271523179&lt;/values&gt;
    &lt;values&gt;158.08531037527592&lt;/values&gt;
    &lt;values&gt;158.45835584842285&lt;/values&gt;
    ...
  &lt;/columns&gt;
  &lt;labels&gt;CpuRawUser&lt;/labels&gt;
  &lt;timestamps&gt;1425581100000&lt;/timestamps&gt;
  &lt;timestamps&gt;1425581400000&lt;/timestamps&gt;
  &lt;timestamps&gt;1425581700000&lt;/timestamps&gt;
  ...
&lt;/query-response&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_posts_读取数据">POSTs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/measurements</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">检索一个或多个属性，可能跨越多个资源的指标度量值，支持 JEXL 表达式。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>这里，我们使用 POST 而不是 GET 来检索指标度量值，这允许我们在查询中执行复杂的表达式。
这些请求不能用于更新或创建新的指标度量。</p>
</div>
<div class="paragraph">
<p>下面是一个可用 POST 实体的实例。</p>
</div>
</div>
<div class="sect4">
<h5 id="_基于_curl_使用实例">基于 curl 使用实例</h5>
<div class="listingblock">
<div class="title">检索特定接口的流入和流出指标度量值。对 bits 进行计算，并且只返回派生值。</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST  -H "Accept: application/json" -H "Content-Type: application/json" -u admin:admin  -d @report.json  http://127.0.0.1:8980/opennms/rest/measurements</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Contents of report.json</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "start": 1425563626316,
    "end": 1425585226316,
    "step": 10000,
    "maxrows": 1600,
    "source": [
        {
            "aggregation": "AVERAGE",
            "attribute": "ifHCInOctets",
            "label": "ifHCInOctets",
            "resourceId": "nodeSource[Servers:1424038123222].interfaceSnmp[eth0-04013f75f101]",
            "transient": "false"
        },
        {
            "aggregation": "AVERAGE",
            "attribute": "ifHCOutOctets",
            "label": "ifHCOutOctets",
            "resourceId": "nodeSource[Servers:1424038123222].interfaceSnmp[eth0-04013f75f101]",
            "transient": "true"
        }
    ],
    "expression": [
        {
            "label": "ifHCOutOctetsNeg",
            "value": "-1.0 * ifHCOutOctets",
            "transient": "false"
        }
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">{
    "step": 300000,
    "start": 1425563626316,
    "end": 1425585226316,
    "timestamps": [
        1425563700000,
        1425564000000,
        1425564300000,
        ...
    ],
    "labels": [
        "ifHCInOctets",
        "ifHCOutOctetsNeg"
    ],
    "columns": [
        {
            "values": [
                139.94817275747508,
                199.0062569213732,
                162.6264894795127,
                ...
            ]
        },
        {
            "values": [
                -151.66179401993355,
                -214.7415503875969,
                -184.9012624584718,
                ...
            ]
        }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_更高级的表达方式">更高级的表达方式</h5>
<div class="paragraph">
<p>The JEXL 2.1.x library is used to parse the expression string and this also allows java objects and predefined functions to be included in the expression.</p>
</div>
<div class="paragraph">
<p>JEXL uses a context which is pre-populated by OpenNMS with the results of the query.
Several constants and arrays are also predefined as references in the context by OpenNMS.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constant or prefix</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__inf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double.POSITIVE_INFINITY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__neg_inf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double.NEGATIVE_INFINITY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NaN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double.NaN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Math.E</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__PI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.Math.PI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__diff_time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time span between start and end of samples</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__i</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Index into the samples array which the present calculation is referencing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">__AttributeName (where AttributeName is the searched for attribute)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This returns the complete double[] array of samples for AttributeName</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>OpenNMS predefines a number of functions for use in expressions which are referenced by namespace:function.
All of these functions return a java double value.</p>
</div>
<div class="paragraph">
<p>Pre defined functions</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">jexl:evaluate("_formula"):</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Passes a string to the JEXL engine to be evaluated as if it was entered as a normal expression.
Like normal expressions, expressions evaluated through this function will return a Java double value.
This makes it possible to reference and evaluate a formula which has been stored in OpenNMS as a string variable.
The use case for this capability is that it gives us the ability to define and store a per-node and per-value correction formula which can normalise samples from different sample sources.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">math:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References java.lang.Math class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">math:cos(20)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strictmath:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References java.lang.StrictMath class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">math:cos(20)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the class org.opennms.netmgt.measurements.impl.SampleArrayFunctions.
This contains several functions which can reference previous samples in the time series.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayNaN("sampleName", n)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the nth previous sample in the "sampleName" sample series. Replacing the n samples before the start of the series with NaN.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayNaN("x", 5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayZero("sampleName", n)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the nth previous sample in the "sampleName" sample series. Replacing the n samples before the start of the series with 0 (zero).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayZero("x", 5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayFirst("sampleName", n)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the nth previous sample in the "sampleName" sample series. Replacing the n samples before the start of the series with the first sample.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayFirst("x", 5)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayStart("sampleName", n, constant)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">References the nth previous sample in the "sampleName" sample series. Replacing the n samples before the start of the series with a supplied constant.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fn:arrayStart("x", 5, 10)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So for example with these additional variables and functions it is possible to create a Finite Impulse Response (FIR) filter function such as</p>
</div>
<div class="listingblock">
<div class="content">
<pre>y = a * f(n) + b * f(n-1) + c * f(n-2)</pre>
</div>
</div>
<div class="paragraph">
<p>using the following expression where a,b and c are string constants and x is a time series value</p>
</div>
<div class="listingblock">
<div class="content">
<pre>a * x + b * fn:arrayNaN("x", 1) + c * fn:arrayNaN("x", 2)</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_设备">5.9.15. 设备</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
默认偏移量 offset 为0，默认限制 limit 结果为10。要获取所有的结果，使用限制 limit=0 作为 URL 上的参数(即, GET /nodes?limit=0)。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>另外，在下面的查询中使用 "id" 的任何地方，都可以使用冒号分隔外部源和外部源ID (例如, GET /nodes/fs:fid)。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_12">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取设备列表。这包括 ID 和设备名称。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过 ID 获取指定设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备关联的 IP 接口列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定设备和 IP 地址的 IP 接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备和IP接口相关联的服务列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}/services/{service}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备、IP接口和服务名相关联的请求服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/snmpinterfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备关联的 SNMP 接口列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/snmpinterfaces/{ifIndex}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备关联的指定接口和索引。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备关联的设备分类列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/categories/{categoryName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备和设备分类名关联的分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/assetRecord</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与给定设备关联的资产记录。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_6">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要的 XML 表单数据使用 application/xml 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向设备添加 IP 接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向指定设备的接口添加服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/snmpinterfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向设备添加 SNMP 接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向设备添加设备分类关联。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="rest-api-nodes-put">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">修改给定ID的设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用给定的设备ID和IP地址修改IP接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/ipinterfaces/{ipAddress}/services/{service}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用给定的设备ID，IP地址和服务名修改服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/snmpinterfaces/{ifIndex}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用给定的设备ID和索引来修改SNMP接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/nodes/{id}/categories/{categoryName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用给定的设备ID和分类名修改设备分类。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_6">DELETEs (删除数据)</h5>
<div class="paragraph">
<p>执行 DELETE 的单独URLs操作，类似上面的 <a href="#rest-api-nodes-put">PUT</a> ，来删除该对象。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
设备、IP接口和服务的删除是异步的，因此它们将返回 202 (ACCEPTED)。删除 snmpinterfaces 和类别是同步调用，因此它们将在成功时返回 204 (NO_CONTENT)。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_通知">5.9.16. 通知</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
默认偏移量 offset 为 0，默认限制 limit 为 10 条记录。
      要获取所有的结果，使用限制 limit=0 作为 URL 上的参数(即, GET /notifications?limit=0)。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_13">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/notifications</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取通知列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/notifications/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取通知的数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em>。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/notifications/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的通知。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>若要确认或取消确认通知，请使用 <code>acks</code> 侧功能&#8201;&#8212;&#8201;参见 <a href="#rest-api-acknowledgements">Acknowledgements</a>。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_故障时间轴">5.9.17. 故障时间轴</h4>
<div class="sect4">
<h5 id="_gets_读取数据_14">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> <code>/header/{start}/{end}/{width}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">生成时间轴标题</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> <code>/image/{nodeId}/{ipAddress}/{serviceName}/{start}/{end}/{width}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">生成时间轴图像</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> <code>/empty/{start}/{end}/{width}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">为非监控服务生成空时间轴</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> <code>/html/{nodeId}/{ipAddress}/{serviceName}/{start}/{end}/{width}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">生成图像的原始 HTML</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_故障">5.9.18. 故障</h4>
<div class="sect4">
<h5 id="_gets_读取数据_15">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/outages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取故障清单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/outages/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取故障数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em>。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/outages/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 <em>ID</em> 的故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/outages/forNode/{nodeId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定设备 <em>ID</em> 匹配的故障。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_requisitions_设备表单">5.9.19. Requisitions (设备表单)</h4>
<div class="paragraph">
<p><em>RESTful</em> 服务的 OpenNMS Horizon 供应设备表单。
在这个 _API_中，设备的这些“组”被恰当地命名，并作为设备表单。</p>
</div>
<div class="paragraph">
<p>当前实现了 <em>CRUD</em> 操作，来管理供应设备表单。
设备表单首先是 <em>POSTed</em>，并且不提供 (导入/同步) 操作。
这样做的原因是 a) <em>XML</em> 可以被验证 b) 使得操作可以在稍后的时间发生。
当导入运行时，它们被移入部署状态 (放置在活动的设备表单库中)。</p>
</div>
<div class="paragraph">
<p>如果请求要获取 <em>active</em> 设备表单，这意味着如果存在就绪请求 (被编辑部署的)，则返回就绪设备表单，否则返回已部署的设备表单。
注意，所有这些 <em>添加/删除/修改， 一个 _设备</em>, <em>接口</em>， 等内容都是指从 <em>设备表单</em> 而不是从数据库本身修改那些元素。
只有在 导入/同步 后才完成操作。</p>
</div>
<div class="paragraph">
<p>只有在 <em>provision</em>, <em>rest</em>, 或 <em>admin</em> 角色中验证用户，才能编写设备表单数据。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_16">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有生效的设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取生效的设备表单数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em>。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/deployed</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有部署的 (生效的) 设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/deployed/count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取部署的设备表单数量。 (返回明文，而不是 <em>XML</em> 或 <em>JSON</em>。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定外部源名称的有效设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定外部源名称的表单里的设备列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定外部源名称及外部 <em>ID</em> 对应的设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定外部源名称及外部 <em>ID</em> 对应的设备接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用指定的外部 <em>ID</em> 和外部源名称获取给定IP接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定IP地址，外部源 <em>ID</em>，和外部源名称对应的接口服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}/services/{service}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定IP地址，外部源 <em>ID</em>，和外部源名称对应的服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定外部 <em>ID</em> 和外部源名称对应的设备分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/categories/{categoryName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定外部 <em>ID</em> 和外部源名称以及分类名称对应的设备分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/assets</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定外部 <em>ID</em> 和外部源名称对应设备资产。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/assets/{assetName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取与指定外部 <em>ID</em> 和外部源名称以及资产名称对应的设备资产。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据或更新现有数据">POSTs (添加数据或更新现有数据)</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
需要是 JSON/XML
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加 (或替换) 设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加 (或替换) 指定设备表单的设备。当使用 <a id="大规模设备表单"></a> 时，此操作可能非常有用。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在指定的设备表单中添加 (或替换) 给定设备的接口。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}/services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对指定的设备表单中的给定接口添加 (或替换) 服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/categories</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在指定的设备表单中添加 (或替换) 给定设备的分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/assets</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在指定的设备表单中添加 (或替换) 给定设备的资产。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_9">PUTs (修改数据)</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
需要是 form-urlencoded
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对指定的外部源执行 导入/同步。这将使 "活动" 的设备表单变成 "部署" 状态。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/import?rescanExisting=false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">对指定的外部源执行 导入/同步。这将使 "活动" 的设备表单变成 "部署" 状态。现有的设备将不会扫描直到下一个重新扫描周期，只有新添加的设备才会被扫描。这对做一系列改变非常有用。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新指定的外部源。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">为给定的外部源更新指定的设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新给定设备和外部源的指定IP地址。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_7">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除指定外部源名称的就绪设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/deployed/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除指定外部源名称的生效设备表单。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从设备表单中删除给定外部 <em>ID</em> 的设备。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用给定的外部 <em>ID</em> 和外部源删除表单设备的IP地址。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/interfaces/{ipAddress}/services/{service}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用给定的IP地址，外部 <em>ID</em> 和外部源删除表单接口的服务。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/categories/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用给定的外部 <em>ID</em> 和外部源删除设备的分类。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/requisitions/{name}/nodes/{foreignId}/assets/{field}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">用给定的外部 <em>ID</em> 和外部源删除表单设备的资产字段。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_资源_api">5.9.20. 资源 API</h4>
<div class="paragraph">
<p><em>资源 API</em> 可以用来在设备级别和更下级列出或删除资源。
此服务与 <em>指标度量 API</em> 相结合尤其有用。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_17">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/resources</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">检索系统中完整的资源树 (耗时的，谨慎使用)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/resources/{resourceId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从命名资源ID开始检索资源树</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/resources/fornode/{nodeCriteria}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">给定一个设备的数据库ID或外部源ID <code>foreign-source:foreign-ID</code>，检索资源树</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_8">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/resources/{resourceId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除指定命名资源ID及其子资源</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>下表显示所有支持的查询字符串参数及其默认值。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名称</th>
<th class="tableblock halign-left valign-top">名称</th>
<th class="tableblock halign-left valign-top">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">depth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">varies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">只支持 GET。
                    限制检索资源树的深度。
                    当列出所有资源时，默认为1，或当列出单个资源时默认为 -1 (无限制)。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_基于_curl_使用实例_2">基于 curl 使用实例</h5>
<div class="listingblock">
<div class="title">通过资源ID方式检索数据库中设备为 <code>1</code> 的资源树</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://127.0.0.1:8980/opennms/rest/resources/node%5B1%5D"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;resource id="node[1]"
          label="anode"
          name="1"
          link="element/node.jsp?node=1"
          typeLabel="Node"&gt;
  &lt;children count="11" totalCount="11"&gt;
    &lt;resource id="node[1].nodeSnmp[]"
              label="Node-level Performance Data"
              name=""
              typeLabel="SNMP Node Data"
              parentId="node[1]"&gt;
      &lt;children/&gt;
      &lt;stringPropertyAttributes/&gt;
      &lt;externalValueAttributes/&gt;
      &lt;rrdGraphAttributes&gt;
        &lt;entry&gt;
          &lt;key&gt;loadavg1&lt;/key&gt;
          &lt;value name="loadavg1"
                 relativePath="snmp/1"
                 rrdFile="loadavg1.jrb"/&gt;
        &lt;/entry&gt;
          &lt;key&gt;tcpActiveOpens&lt;/key&gt;
          &lt;value name="tcpActiveOpens"
                 relativePath="snmp/1"
                 rrdFile="tcpActiveOpens.jrb"/&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;key&gt;memTotalFree&lt;/key&gt;
          &lt;value name="memTotalFree"
                 relativePath="snmp/1"
                 rrdFile="memTotalFree.jrb"/&gt;
        &lt;/entry&gt;
        ...
      &lt;/rrdGraphAttributes&gt;
    &lt;/resource&gt;
    &lt;resource id="node[1].interfaceSnmp[lo]"
              label="lo (10 Mbps)"
              name="lo"
              link="element/snmpinterface.jsp?node=1&amp;amp;ifindex=1"
              typeLabel="SNMP Interface Data"
              parentId="node[1]"&gt;
      &lt;children/&gt;
      &lt;stringPropertyAttributes&gt;
        &lt;entry&gt;
          &lt;key&gt;ifName&lt;/key&gt;
          &lt;value&gt;lo&lt;/value&gt;
        &lt;/entry&gt;
        ...
      &lt;/stringPropertyAttributes&gt;
      &lt;externalValueAttributes&gt;
        &lt;entry&gt;
          &lt;key&gt;ifSpeed&lt;/key&gt;
          &lt;value&gt;10000000&lt;/value&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;key&gt;ifSpeedFriendly&lt;/key&gt;
          &lt;value&gt;10 Mbps&lt;/value&gt;
        &lt;/entry&gt;
      &lt;/externalValueAttributes&gt;
      &lt;rrdGraphAttributes&gt;
        ...
        &lt;entry&gt;
          &lt;key&gt;ifHCInOctets&lt;/key&gt;
          &lt;value name="ifHCInOctets"
                 relativePath="snmp/1/lo"
                 rrdFile="ifHCInOctets.jrb"/&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;key&gt;ifHCOutOctets&lt;/key&gt;
          &lt;value name="ifHCOutOctets"
                 relativePath="snmp/1/lo"
                 rrdFile="ifHCOutOctets.jrb"/&gt;
        &lt;/entry&gt;
        ...
      &lt;/rrdGraphAttributes&gt;
    &lt;/resource&gt;
    ...
  &lt;/children&gt;
  &lt;stringPropertyAttributes/&gt;
  &lt;externalValueAttributes/&gt;
  &lt;rrdGraphAttributes/&gt;
&lt;/resource&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve the tree of resources rooted at the node with database ID <code>1</code>, without having to construct a resource ID</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://127.0.0.1:8980/opennms/rest/resources/fornode/1"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve the tree of resources rooted at the node with foreign-ID <code>node42</code> in requisition <code>Servers</code>, by resource ID</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://127.0.0.1:8980/opennms/rest/resources/nodeSource%5BServers:node42%5D"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Retrieve the tree of resources rooted at the node with foreign-ID <code>node42</code> in requisition <code>Servers</code>, without having to construct a resource ID</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://127.0.0.1:8980/opennms/rest/resources/fornode/Servers:node42"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_实时控制台数据">5.9.21. 实时控制台数据</h4>
<div class="paragraph">
<p><em>实时控制台 (RTC)</em> 计算受监控服务的可用性。
从 <em>RTC</em> 提供的数据可用于 ReST API。</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_18">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/availability/categories/{category}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从给定的 SLA 类别过滤器获取所有设备和可用性数据，例如，Web Servers (Web+Servers)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/availability/categories/{category}/nodes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定 SLA 类别过滤器的每个设备的可用性数据</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/availability/categories/{category}/nodes/{nodeId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在给定的 SLA 类别过滤器中获取指定设备的详细服务可用性</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/availability/nodes/{nodeId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定设备上所有服务的详细可用性</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_实例">实例</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u demo:demo http://demo.opennms.org/opennms/rest/availability/categories/Web+Servers
curl -u demo:demo http://demo.opennms.org/opennms/rest/availability/categories/nodes
curl -u demo:demo http://demo.opennms.org/opennms/rest/availability/categories/nodes/31
curl -u demo:demo http://demo.opennms.org/opennms/rest/availability/nodes/31</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_计划故障">5.9.22. 计划故障</h4>
<div class="sect4">
<h5 id="_gets_读取数据_19">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取配置的计划故障列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取具体的故障详情。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_设置数据_2">POSTs (设置数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加新的故障 (或更新现有的故障)。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_10">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/collectd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向采集包配置中添加特定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/pollerd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向轮询包配置中添加特定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/threshd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向门限包配置中添加特定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/notifd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向通知包配置中添加特定故障。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_9">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除指定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/collectd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从采集配置包中删除指定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/pollerd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从轮询配置包中删除指定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/threshd/{package}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从门限配置包中删除指定故障。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/sched-outages/{outageName}/notifd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从通知配置包中删除指定故障。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_snmp_配置">5.9.23. SNMP 配置</h4>
<div class="paragraph">
<p>您可以使用该接口编辑IP地址的团体名，SNMP版本等。如果做了与现有 snmp-config.xml 配置重叠的更改，它将根据需要自动创建 &lt;definition /&gt; 条目组。如果没有创建 &lt;definition /&gt; 条目，则匹配默认值。</p>
</div>
<div class="paragraph">
<p>这里的接口有不同的版本 (见下文)。
支持以下操作：</p>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_20">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/snmpConfig/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取给定IP地址的SNMP配置。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/snmpConfig/{ipAddress}?location={location}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在给定位置获取指定IP地址的SNMP配置。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_11">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/snmpConfig/{ipAddress}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">为给定的IP地址添加或更新SNMP配置。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_确定_api_版本">确定 API 版本</h5>
<div class="paragraph">
<p>要确定在 OpenNMS Horizon 中运行的 <em>API</em> 版本，请在浏览器中键入 <a href="http://localhost:8980/opennms/rest/snmpConfig/1.1.1.1" class="bare">http://localhost:8980/opennms/rest/snmpConfig/1.1.1.1</a> ，并查看输出：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Version 1:</strong> 如果输出只有属性 <code>community</code>, <code>port</code>, <code>retries</code>, <code>timeout</code> 和 <code>version</code></p>
</li>
<li>
<p><strong>Version 2:</strong> 如果有比前面描述的更多的属性 (例如，最大重复数)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_api_版本1">API 版本1</h5>
<div class="paragraph">
<p>在版本1中，只支持在 <code>snmp-config.xsd</code> 中定义的几个属性。
在 <code>snmp-info.xsd</code> 中的定义:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;xs:schema
    xmlns:tns="http://xmlns.opennms.org/xsd/config/snmp-info"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified"
    version="1.0"
    targetNamespace="http://xmlns.opennms.org/xsd/config/snmp-info"&gt;
  &lt;xs:element name="snmp-info" type="tns:snmpInfo"/&gt;
  &lt;xs:complexType name="snmpInfo"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="community" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="port" type="xs:int"/&gt;
      &lt;xs:element name="retries" type="xs:int"/&gt;
      &lt;xs:element name="timeout" type="xs:int"/&gt;
      &lt;xs:element name="version" type="xs:string" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:schema&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>下表显示了所有支持的属性，可选值、限定值以及 <code>snmp-info.xsd</code> 和 <code>snmp-config.xsd</code> 之间的映射。
无论什么版本，都可以设置这些参数。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">snmp-info.xml 的属性</th>
<th class="tableblock halign-left valign-top">snmp-config.xml 的属性</th>
<th class="tableblock halign-left valign-top">默认值</th>
<th class="tableblock halign-left valign-top">限于版本</th>
<th class="tableblock halign-left valign-top">限定值</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"v1", "v2c" 或 "v3" 都是有效的参数。
                                                                                          如果提供了无效或空的参数，则使用 "v1"。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">161</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">community</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-community</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">长度 &gt;= 1 的任何字符串</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">例子1:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X PUT -H "Content-Type: application/xml" \
     -H "Accept: application/xml" \
     -d "&amp;lt;snmp-info&amp;gt;
             &amp;lt;community&amp;gt;yRuSonoZ&amp;lt;/community&amp;gt;
             &amp;lt;port&amp;gt;161&amp;lt;/port&amp;gt;
             &amp;lt;retries&amp;gt;1&amp;lt;/retries&amp;gt;
             &amp;lt;timeout&amp;gt;2000&amp;lt;/timeout&amp;gt;
             &amp;lt;version&amp;gt;v2c&amp;lt;/version&amp;gt;
          &amp;lt;/snmp-info&amp;gt;" \
     -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 <code>snmp-config.xml</code> 中创建或更新IP地址 10.1.1.1 的 <code>&lt;definition/&gt;</code>-条目。</p>
</div>
<div class="listingblock">
<div class="title">例子2:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X GET -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回如示例1中定义的IP地址 10.1.1.1 的SNMP配置。</p>
</div>
</div>
<div class="sect4">
<h5 id="_api_版本2">API 版本2</h5>
<div class="paragraph">
<p>由于版本2 <code>snmp-config.xsd</code> 中定义的 <code>&lt;definition /&gt;</code> 所有属性都可以通过接口设置或获取 - 但是只能通过IP地址进行设置，而不能通过IP地址范围。
这在将来可能会改变。</p>
</div>
<div class="paragraph">
<p>接口使用 <em>SnmpInfo</em> 对象进行通信。
因此，可以在一个请求中设置 v1 和 v3 参数 (例如 <code>readCommunity</code> 团体名和 <code>privProtocol</code> 字符串)。
但是 OpenNMS Horizon 不允许这样做。
只允许设置没有版本限制的属性 (例如，超时值)，或仅限于版本的属性 (例如 <code>readCommunity</code> 团体名，如果是版本 v1/v2c)。
对于从 <em>API</em> 获取数据也是一样的，即使可以手动将 v1 和 v3 参数存储在 <code>snmp-config.xml</code> 中的一个定义块中，但是 <em>ReST API</em> 只返回与版本匹配的参数。
如果没有定义版本，则假定默认值 (无论是 <em>PUT</em> 和 <em>GET</em> 请求)。</p>
</div>
<div class="paragraph">
<p><em>SnmpInfo</em> 模型定义如下:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;xs:schema
  elementFormDefault="qualified"
  version="1.0"
  targetNamespace="http://xmlns.opennms.org/xsd/config/snmp-info"
  xmlns:tns="http://xmlns.opennms.org/xsd/config/snmp-info"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;

  &lt;xs:element name="snmp-info" type="tns:snmpInfo"/&gt;
  &lt;xs:complexType name="snmpInfo"&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name="authPassPhrase" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="authProtocol" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="community" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="contextEngineId" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="contextName" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="engineId" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="enterpriseId" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="maxRepetitions" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="maxRequestSize" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="maxVarsPerPdu" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="port" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="privPassPhrase" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="privProtocol" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="proxyHost" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="readCommunity" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="retries" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="securityLevel" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="securityName" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="timeout" type="xs:int" minOccurs="0"/&gt;
      &lt;xs:element name="version" type="xs:string" minOccurs="0"/&gt;
      &lt;xs:element name="writeCommunity" type="xs:string" minOccurs="0"/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:schema&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>下表显示了所有支持的属性，<code>snmp-info.xsd</code> 和 <code>snmp-config.xsd</code> 之间的映射。
它还列出了版本限制，默认值和限定值 - 如果有的话。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">snmp-info.xml 的属性</th>
<th class="tableblock halign-left valign-top">snmp-config.xml 的属性</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">默认值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">限于版本</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">限定值</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"v1", "v2c" 或 "v3" 是有效的参数。
                                                                                               如果提供了无效或空参数，则使用 "v1"。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">161</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">retries</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeout</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxVarsPerPdu</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-vars-per-pdu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxRepetitions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-repetitions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxRequestSize</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">max-request-size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65535</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer &gt; 0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">proxyHost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">proxy-host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">readCommunity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-community</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">public</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1, v2c</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeCommunity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write-community</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">private</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1, v2c</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">securityName</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">opennmsUser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">securityLevel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">security-level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">noAuthNoPriv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer value, which can be null, 1, 2, or 3. &lt;ul&gt;&lt;li&gt;1 means noAuthNoPriv&lt;/li&gt;&lt;li&gt;2 means authNoPriv&lt;/li&gt;&lt;li&gt;3 means authPriv&lt;/li&gt;&lt;/ul&gt; If you do not set the security level manually it is determined automatically: &lt;ul&gt;&lt;li&gt;if no authPassPhrase set the securityLevel is 1&lt;/li&gt;&lt;li&gt;if a authPassPhrase and no privPassPhrase is set the security level is 2.&lt;/li&gt;&lt;li&gt;if a authPassPhrase and a privPassPhrase is set the security level is 3.&lt;/li&gt;&lt;/ul&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">authPassPhrase</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">auth-passphrase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0p3nNMSv3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">authProtocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">auth-protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">只有 MD5 或 SHA 是有效参数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">privPassPhrase</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">privacy-passphrase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0p3nNMSv3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">privProtocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">privacy-protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">只有 DES, AES, AES192 或 AES256 是有效参数。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">engineId</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">engine-id</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contextEngineId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">context-engine-id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">contextName</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">context-name</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enterpriseId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enterprise-id</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v3</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">示例1:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X PUT -H "Content-Type: application/xml" \
     -H "Accept: application/xml" \
     -d "&amp;lt;snmp-info&amp;gt;
             &amp;lt;readCommunity&amp;gt;yRuSonoZ&amp;lt;/readCommunity&amp;gt;
             &amp;lt;port&amp;gt;161&amp;lt;/port&amp;gt;
             &amp;lt;retries&amp;gt;1&amp;lt;/retries&amp;gt;
             &amp;lt;timeout&amp;gt;2000&amp;lt;/timeout&amp;gt;
             &amp;lt;version&amp;gt;v2c&amp;lt;/version&amp;gt;
          &amp;lt;/snmp-info&amp;gt;" \
     -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 <code>snmp-config.xml</code> 中创建或更新IP地址为10.1.1.1的 <code>&lt;definition/&gt;</code>-条目。</p>
</div>
<div class="listingblock">
<div class="title">示例2:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X GET -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>返回如示例1中定义的IP地址 10.1.1.1 的SNMP配置。</p>
</div>
<div class="listingblock">
<div class="title">示例3:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X PUT -H "Content-Type: application/xml" \
     -H "Accept: application/xml" \
     -d "&amp;lt;snmp-info&amp;gt;
             &amp;lt;readCommunity&amp;gt;yRuSonoZ&amp;lt;/readCommunity&amp;gt;
             &amp;lt;port&amp;gt;161&amp;lt;/port&amp;gt;
             &amp;lt;retries&amp;gt;1&amp;lt;/retries&amp;gt;
             &amp;lt;timeout&amp;gt;2000&amp;lt;/timeout&amp;gt;
             &amp;lt;version&amp;gt;v1&amp;lt;/version&amp;gt;
             &amp;lt;securityName&amp;gt;secret-stuff&amp;lt;/securityName&amp;gt;
             &amp;lt;engineId&amp;gt;engineId&amp;lt;/engineId&amp;gt;
          &amp;lt;/snmp-info&amp;gt;" \
     -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 <code>snmp-config.xml</code> 中为IP地址 10.1.1.1 创建或更新 <code>&lt;definition/&gt;</code>-条目，忽略属性 <code>securityName</code> 和 <code>engineId</code>。</p>
</div>
<div class="listingblock">
<div class="title">示例4:</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -v -X PUT -H "Content-Type: application/xml" \
     -H "Accept: application/xml" \
     -d "&amp;lt;snmp-info&amp;gt;
             &amp;lt;readCommunity&amp;gt;yRuSonoZ&amp;lt;/readCommunity&amp;gt;
             &amp;lt;port&amp;gt;161&amp;lt;/port&amp;gt;
             &amp;lt;retries&amp;gt;1&amp;lt;/retries&amp;gt;
             &amp;lt;timeout&amp;gt;2000&amp;lt;/timeout&amp;gt;
             &amp;lt;version&amp;gt;v3&amp;lt;/version&amp;gt;
             &amp;lt;securityName&amp;gt;secret-stuff&amp;lt;/securityName&amp;gt;
             &amp;lt;engineId&amp;gt;engineId&amp;lt;/engineId&amp;gt;
          &amp;lt;/snmp-info&amp;gt;" \
     -u admin:admin http://localhost:8980/opennms/rest/snmpConfig/10.1.1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 <code>snmp-config.xml</code> 中创建或更新一个 <code>&lt;definition/&gt;</code>-条目，忽略 <code>readCommunity</code> 属性。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_用户">5.9.24. 用户</h4>
<div class="paragraph">
<p>由于用户当前没有存储在数据库中，所以它的 ReST 接口不如设备那样完整。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
不能使用 hibernate 标准过滤条件。
你首先需要创建文件 <code>$OPENNMS_HOME/etc/users.xml</code> ，然后才能添加或修改用户 (参见 <a href="http://jira.opennms.org/browse/NMS-6469">NMS-6469</a> 以获取详细信息)。
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_gets_读取数据_21">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取用户列表。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/{username}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通过用户名获取用户。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_7">POSTs (添加数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加用户。如果提供密码，则假定已经加密，在 1.12.5 版本后。
              为了指示所提供的密码使用 salted 加密算法，而不是使用旧的 <em>MD5</em> 算法，需要在密码元素后面传递一个名为 <code>passwordSalt</code> 的元素，其文本为 <code>true</code> (如果使用 <em>JSON</em>，则传递 键/值 对)。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_12">PUTs (修改数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">参数</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/{username}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新现有用户的全名，用户说明，密码和时间计划。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/{username}/roles/{rolename}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">向用户添加安全角色。 (OpenNMS 19 的新功能)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_10">DELETEs (删除数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/{username}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除用户。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/users/{username}/roles/{rolename}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">从用户中移除安全角色。 (OpenNMS 19 的新功能)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_snmp_trap_北向接口配置">5.9.25. SNMP Trap 北向接口配置</h4>
<div class="sect4">
<h5 id="_gets_读取数据_22">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取配置的完整内容。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取 SNMP Trap NBI 的状态(返回 true 或 false)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取当前所有目标名称。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取目标名称为 {name} 的内容</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_更新默认值">PUTs (更新默认值)</h5>
<div class="paragraph">
<p>请求成功后，将通知 SNMP Trap NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/status?enabled=(true;false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">设置 SNMP Trap NBI 的状态。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_8">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>请求成功后，将通知 SNMP Trap NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新配置的完整内容。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加新的或覆盖现有的目标。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_13">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>请求成功后，将通知 SNMP Trap NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新名为 {name} 的目标内容</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_11">DELETEs (删除数据)</h5>
<div class="paragraph">
<p>请求成功后，将通知 SNMP Trap NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/snmptrap-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新目标名为 {name} 的内容</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_email_北向接口配置">5.9.26. Email 北向接口配置</h4>
<div class="sect4">
<h5 id="_gets_读取数据_23">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取配置的完整内容。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取 Email NBI 的状态 (返回 true 或 false)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取所有当前目标名称。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取目标名称 {name} 的内容</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_更新默认值_2">PUTs (更新默认值)</h5>
<div class="paragraph">
<p>一个成功的请求，将通知 Email NBI 关于配置改变。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/status?enabled=(true;false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">设置 Email NBI 的状态。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_9">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>一个成功的请求，将通知 Email NBI 关于配置改变。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加新的或覆盖现有的目标配置。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_14">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>一个成功的请求，将通知 Email NBI 关于配置改变。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新目标名为 {name} 的内容</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_12">DELETEs (删除数据)</h5>
<div class="paragraph">
<p>一个成功的请求，将通知 Email NBI 关于配置改变。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/email-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">删除名为 {name} 的目标</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_javamail_configuration">5.9.27. Javamail Configuration</h4>
<div class="sect4">
<h5 id="_gets_reading_data_4">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/default/readmail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the name of the default readmail config.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/default/sendmail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the name of the default sendmail config.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/readmails</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the name of all the existing readmail configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/sendmails</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the name of all the existing sendmail configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/end2ends</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the name of all the existing end2end mail configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/readmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the content of the readmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/sendmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the content of the sendmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/end2ends/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the content of the end2end mail configuration named {name}</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_addingupdating_data">POSTs (Adding/Updating Data)</h5>
<div class="paragraph">
<p>POST requires form data using application/xml or application/json as a Content-Type.</p>
</div>
<div class="paragraph">
<p>On a successful request, the Email NBI will be notified about the configuration change.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/readmails</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a new or overrides an existing readmail configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/sendmails</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a new or overrides an existing sendmail configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/end2ends</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds a new or overrides an existing end2ends mail configuration.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_update_defaults">PUTs (Update defaults)</h5>
<div class="paragraph">
<p>On a successful request, the Email NBI will be notified about the configuration change.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config/javamail/default/readmail/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the readmail named {name} as the new default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config/javamail/default/sendmail/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the sendmail named {name} as the new default.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_modifying_data">PUTs (Modifying Data)</h5>
<div class="paragraph">
<p>PUT requires form data using application/x-www-form-urlencoded as a Content-Type.</p>
</div>
<div class="paragraph">
<p>On a successful request, the Email NBI will be notified about the configuration change.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/readmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates the content of the readmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/sendmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates the content of the sendmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/end2ends/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updates the content of the end2end mail configuration named {name}</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_remove_data">DELETEs (Remove Data)</h5>
<div class="paragraph">
<p>On a successful request, the Email NBI will be notified about the configuration change.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/readmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removes the readmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/sendmails/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removes the sendmail configuration named {name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/javamail/end2ends/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removes the end2end mail configuration named {name}</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_syslog_北向接口配置">5.9.28. Syslog 北向接口配置</h4>
<div class="sect4">
<h5 id="_gets_读取数据_24">GETs (读取数据)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取完整的配置内容。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取 Syslog NBI 的状态 (返回 true 或 false)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取当前所有目标名称。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">获取指定名称 {name} 的目标内容。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_更新默认值_3">PUTs (更新默认值)</h5>
<div class="paragraph">
<p>请求成功后，将通知 Syslog NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/status?enabled=(true;false)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">设置 Syslog NBI 的状态。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_添加数据_10">POSTs (添加数据)</h5>
<div class="paragraph">
<p>POST 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>请求成功后，将通知 Syslog NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新配置的完整内容。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/destinations</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">添加新的或覆盖现有的目标。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_修改数据_15">PUTs (修改数据)</h5>
<div class="paragraph">
<p>PUT 需要的表单数据使用 application/x-www-form-urlencoded 作为 Content-Type。</p>
</div>
<div class="paragraph">
<p>请求成功后，将通知 Syslog NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新名为 {name} 的目标内容</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_删除数据_13">DELETEs (删除数据)</h5>
<div class="paragraph">
<p>请求成功后，将通知 Syslog NBI 配置更改。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/config/syslog-nbi/destinations/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">更新目标名为 {name} 的内容</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_business_service_monitoring">5.9.29. Business Service Monitoring</h4>
<div class="paragraph">
<p>Every aspect of the <em>Business Service Monitoring</em> feature can be controlled via a ReST API.
The API&#8217;s endpoint for managing <em>Business Services</em> is located at <code>/opennms/api/v2/business-services</code>.
It supports <em>XML</em> content to represent the <em>Business Services</em>.
The schema file describing the API model is located in <code>$OPENNMS_HOME/share/xsds/business-service-dto.xsd</code>.
The responses generated by the ReST API do also include <code>location</code> elements that contain references to other entities managed by the API.
The <em>Business Service</em> response data model for the ReST API has the following basic structure:</p>
</div>
<div class="listingblock">
<div class="title">Sample <em>Business Service</em> details response XML representation</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;business-service&gt;
  &lt;id&gt;42&lt;/id&gt;
  &lt;name&gt;Datacenter North&lt;/name&gt;
  &lt;attributes/&gt;
  &lt;ip-service-edges&gt;
    &lt;ip-service-edge&gt;
      &lt;id&gt;23&lt;/id&gt;
      &lt;operational-status&gt;WARNING&lt;/operational-status&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;location&gt;/api/v2/business-services/2/edges/23&lt;/location&gt;
      &lt;reduction-keys&gt;
        &lt;reduction-key&gt;uei.opennms.org/nodes/nodeLostService::12:10.10.10.42:ICMP&lt;/reductionKey&gt;
        &lt;reduction-key&gt;uei.opennms.org/nodes/nodeDown::12&lt;/reductionKey&gt;
      &lt;/reduction-keys&gt;
      &lt;weight&gt;1&lt;/weight&gt;
    &lt;/ip-service-edge&gt;
  &lt;/ip-service-edges&gt;
  &lt;reduction-key-edges&gt;
    &lt;reduction-key-edge&gt;
      &lt;id&gt;111&lt;/id&gt;
      &lt;operational-status&gt;INDETERMINATE&lt;/operational-status&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;location&gt;/api/v2/business-services/42/edges/111&lt;/location&gt;
      &lt;reduction-keys&gt;
        &lt;reduction-key&gt;my-reduction-key1&lt;/reduction-key&gt;
      &lt;/reduction-keys&gt;
      &lt;weight&gt;1&lt;/weight&gt;
    &lt;/reduction-key-edge&gt;
  &lt;/reduction-key-edges&gt;
  &lt;child-edges&gt;
    &lt;child-edge&gt;
      &lt;id&gt;123&lt;/id&gt;
      &lt;operational-status&gt;MINOR&lt;/operational-status&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;location&gt;/api/v2/business-services/42/edges/123&lt;/location&gt;
      &lt;reduction-keys/&gt;
      &lt;weight&gt;1&lt;/weight&gt;
      &lt;child-id&gt;43&lt;/child-id&gt;
    &lt;/child-edge&gt;
  &lt;/child-edges&gt;
  &lt;parent-services&gt;&lt;parent-service&gt;144&lt;/parent-service&gt;&lt;/parent-services&gt;
  &lt;reduce-function&gt;&lt;type&gt;HighestSeverity&lt;/type&gt;&lt;/reduce-function&gt;
  &lt;operational-status&gt;INDETERMINATE&lt;/operational-status&gt;
  &lt;location&gt;/api/v2/business-services/146&lt;/location&gt;
&lt;/business-service&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample <em>Business Service</em> creation request XML representation</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;business-service&gt;
  &lt;name&gt;Datacenter North&lt;/name&gt;
  &lt;attributes/&gt;
  &lt;ip-service-edges&gt;
    &lt;ip-service-edge&gt;
      &lt;ip-service-id&gt;99&lt;/ip-service-id&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;weight&gt;1&lt;/weight&gt;
    &lt;/ip-service-edge&gt;
  &lt;/ip-service-edges&gt;
  &lt;reduction-key-edges&gt;
    &lt;reduction-key-edge&gt;
      &lt;reduction-key&gt;my-reduction-key1&lt;/reduction-key&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;weight&gt;1&lt;/weight&gt;
    &lt;/reduction-key-edge&gt;
  &lt;/reduction-key-edges&gt;
  &lt;child-edges&gt;
    &lt;child-edge&gt;
      &lt;child-id&gt;43&lt;/child-id&gt;
      &lt;map-function&gt;
        &lt;type&gt;Identity&lt;/type&gt;
      &lt;/map-function&gt;
      &lt;weight&gt;1&lt;/weight&gt;
    &lt;/child-edge&gt;
  &lt;/child-edges&gt;
  &lt;reduce-function&gt;&lt;type&gt;HighestSeverity&lt;/type&gt;&lt;/reduce-function&gt;
&lt;/business-service&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The whole model is defined in <code>jetty-webapps/opennms/WEB-INF/lib/org.opennms.features.bsm.rest.api-*.jar</code> which can be used as a dependency for a Java program to query the API.</p>
</div>
<div class="sect4">
<h5 id="_gets_reading_data_5">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a brief list of all defined <em>Business Services</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the <em>Business Service</em> identified by <code>id</code> included the current operational state</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/egdes/{edgeId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the edge of the <em>Business Service</em> identified by <code>edgeId</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/functions/map</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a list of supported <em>Map Function</em> definitions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/functions/map/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the definition of the <em>Map Function</em> identified by <code>name</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/functions/reduce/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides a list of supported <em>Reduce Function</em> definitions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/functions/reduce/{name}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the definition of the <em>Reduce Function</em> identified by <code>name</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_puts_modifying_data_2">PUTs (Modifying Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modifies an existing <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_posts_adding_data">POSTs (Adding Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a new <em>Business Service</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}/ip-service-edge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds an edge of type <em>IP Service</em> to the <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}/reduction-key-edge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds an edge of type <em>Reduction Key</em> to the <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}/child-edge</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds an edge of type <em>Business Service</em> to the <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/daemon/reload</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reload the configuration of the <em>Business Service Daemon</em></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_deletes_removing_data">DELETEs (Removing Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes the <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/business-services/{id}/edges/{edgeId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removes an edge with the identifier <code>edgeId</code> from the <em>Business Service</em> identified by <code>id</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_设备发现">5.9.30. 设备发现</h4>
<div class="paragraph">
<p>此处可以用来触发一次发现扫描。</p>
</div>
<div class="sect4">
<h5 id="_posts_提交一次扫描配置">POSTs (提交一次扫描配置)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">资源</th>
<th class="tableblock halign-left valign-top">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opennms/api/v2/discovery</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">提交一次扫描配置</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>下面的 XML 结构用于定义扫描任务。</p>
</div>
<div class="listingblock">
<div class="title">配置文件 <code>discovery.xml</code> 示例</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-XML" data-lang="XML">&lt;discoveryConfiguration&gt;
  &lt;specifics&gt;
    &lt;specific&gt;
      &lt;location&gt;Default&lt;/location&gt;
      &lt;retries&gt;3&lt;/retries&gt;
      &lt;timeout&gt;2000&lt;/timeout&gt;
      &lt;foreignSource&gt;My-ForeignSource&lt;/foreignSource&gt;
      &lt;content&gt;192.0.2.1&lt;/content&gt;
    &lt;/specific&gt;
  &lt;/specifics&gt;
  &lt;includeRanges&gt;
    &lt;includeRange&gt;
      &lt;location&gt;Default&lt;/location&gt;
      &lt;retries&gt;3&lt;/retries&gt;
      &lt;timeout&gt;2000&lt;/timeout&gt;
      &lt;foreignSource&gt;My-ForeignSource&lt;/foreignSource&gt;
      &lt;begin&gt;192.0.2.10&lt;/begin&gt;
      &lt;end&gt;192.0.2.254&lt;/end&gt;
    &lt;/includeRange&gt;
  &lt;/includeRanges&gt;
  &lt;excludeRanges&gt;
    &lt;excludeRange&gt;
      &lt;begin&gt;192.0.2.60&lt;/begin&gt;
      &lt;end&gt;192.0.2.65&lt;/end&gt;
    &lt;/excludeRange&gt;
  &lt;/excludeRanges&gt;
  &lt;includeUrls&gt;
    &lt;includeUrl&gt;
      &lt;location&gt;Default&lt;/location&gt;
      &lt;retries&gt;3&lt;/retries&gt;
      &lt;timeout&gt;2000&lt;/timeout&gt;
      &lt;foreignSource&gt;My-ForeignSource&lt;/foreignSource&gt;
      &lt;content&gt;http://192.0.2.254/addresses.txt&lt;/content&gt;
    &lt;/includeUrl&gt;
  &lt;/includeUrls&gt;
&lt;/discoveryConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>可以通过将配置发送到 ReST 端，来触发扫描，如下面的例子：</p>
</div>
<div class="listingblock">
<div class="title">触发一次扫描</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -H "Content-Type: application/xml" -u admin:admin -X POST -d @discovery.xml http://localhost:8980/opennms/api/v2/discovery</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gs-situation-feedback">5.9.31. Situation Feedback</h4>
<div class="paragraph">
<p>Situation Feedback is an optional feature that allows for the management of User Contributed Feedback regarding Correlation of Alarms.</p>
</div>
<div class="paragraph">
<p>It is a simple API that allows for the submission and retrieval of Correlation Feedback.</p>
</div>
<div class="sect4">
<h5 id="_gets_reading_data_6">GETs (Reading Data)</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 90.9091%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/situation-feedback/{situationId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get Situation Feedback for the Situation with AlarmId = {situationId}.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>situationId</em> is the same as the <em>AlarmId</em> for the Situation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_usage_examples_with_curl">Usage examples with curl</h5>
<div class="listingblock">
<div class="title">Retrieve Situation Feedback for the Situaiton with AlarmId == 210</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -u admin:admin "http://localhost:8980/opennms/rest/situation-feedback/210"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">[
    {
        "situationKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:FEEDBACK_A",
        "situationFingerprint": "NDg3ZjdiMjJmNjgzMTJkMmMxYmJjOTNiMWFlYTQ0NWI=",
        "alarmKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:ALARM_A",
        "feedbackType": "CORRECT",
        "reason": "okay",
        "user": "admin",
        "timestamp": 1535057676107
    },
    {
        "situationKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:FEEDBACK_A",
        "situationFingerprint": "NDg3ZjdiMjJmNjgzMTJkMmMxYmJjOTNiMWFlYTQ0NWI=",
        "alarmKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:ALARM_B",
        "feedbackType": "CORRECT",
        "reason": "okay",
        "user": "admin",
        "timestamp": 1535057676107
    }
]</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_posts_adding_data_2">POSTs (Adding Data)</h5>
<div class="paragraph">
<p>POST requires using application/json as a Content-Type.</p>
</div>
<div class="paragraph">
<p>On a successful request, the Feedback will be persisted</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Resource</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/situation-feedback/{situationId}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Submits feedback for the Situation identitified with AlarmId = {situationId}.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_usage_examples_with_curl_2">Usage examples with curl</h5>
<div class="listingblock">
<div class="title">Submit positve Feedback for a Situation with 2 alarms.</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST  -H "Accept: application/json" -H "Content-Type: application/json" -u admin:admin  -d @feedback.json  http://127.0.0.1:8980/opennms/rest/situation-feedback/210</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Contents of feedback.json</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">[
    {
        "situationKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:FEEDBACK_A",
        "situationFingerprint": "NDg3ZjdiMjJmNjgzMTJkMmMxYmJjOTNiMWFlYTQ0NWI=",
        "alarmKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:ALARM_A",
        "feedbackType": "CORRECT",
        "reason": "okay",
        "user": "admin",
        "timestamp": 1535057676107
    },
    {
        "situationKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:FEEDBACK_A",
        "situationFingerprint": "NDg3ZjdiMjJmNjgzMTJkMmMxYmJjOTNiMWFlYTQ0NWI=",
        "alarmKey": "uei.opennms.org/alarms/trigger:localhost:0.0.0.0:ALARM_B",
        "feedbackType": "CORRECT",
        "reason": "okay",
        "user": "admin",
        "timestamp": 1535057676107
    }
]</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Response</div>
<p>204 No Content</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rest_api_examples">5.10. ReST API Examples</h3>
<div class="sect3">
<h4 id="_获得性能图表">5.10.1. 获得性能图表</h4>
<div class="paragraph">
<p>虽然图表在 <em>ReST</em> 技术上是不可用的，但是你可以解析一些 <em>ReST</em> 变量以获得足够的数据来拉取图表。
这不是理想方式，因为它需要多次获取，但要看你的需求，可能是满足需要的。</p>
</div>
<div class="paragraph">
<p>我内嵌了一些 <em>PHP</em> 样例代码，做法是 (根本没有测试，我没有使用 <em>ReST-接口从旧的的代码剪切和复制，和/或使用浏览器，像 YMMV)。
如果你在网管界面上单击资源图，然后右键点击你想要的图标，点击 _查看图像</em> ，你可以得到拉取图表的完整 <em>URL</em> 。</p>
</div>
<div class="paragraph">
<p>使用这个获取的 <em>URL</em> ，就可以从 <em>ReST</em> 拉取你想要的图标。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-php" data-lang="php">function fetchit($thing, $user = "user", $pass = "pass") {
    $url = "http://localhost:8980/opennms";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url . $thing);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
    curl_setopt($ch, CURLOPT_USERPWD, $user.':'.$pass);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
}

// this assumes you already have found the nodeId via a previous REST call or some other means.  Provided more as an example than what you might want.
function getNodeInterfaces($nodeId) {
    $data = fetchit("/rest/nodes/$nodeId/snmpinterfaces");
     return simplexml_load_string($data);
}

function fetchGraphs($nodeId) {
     $ints = getNodeInterfaces($nodeId);
     $chars = array('/','.',':','-',' ');
     $endtime = time();
     $starttime = (string)(time() - ($days * 24 * 60 * 60)) ;

     // use bcmath or a better version of PHP if  you don't want this hypocrisy here.
     $endtime = $endtime . '000';
     $starttime = $starttime . '000';

     for($i=0; $i&lt;count($ints-&gt;snmpInterfaces); $i++) {
         $ifname = $ints-&gt;snmpInterfaces[$i]-&gt;snmpInterface-&gt;ifName;
         $mac = $ints-&gt;snmpInterfaces[$i]-&gt;snmpInterface-&gt;physAddr;
         $if = str_replace($chars, "_", $ifname);
         if ( strlen(trim($mac)) &lt; 12 ) { $mac_and_if = $if; } else { $mac_and_if = $if .'-'. $mac; };

         $image = fetchit("$url/graph/graph.png?resource=node[$nodeId].interfaceSnmp[$mac_and_if]&amp;report=report=mib2.HCbits&amp;start=$starttime&amp;end=$endtime");
         // you can poop this to a file now, or set header('Content-type: image/png'); then print "$image";
     }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_provisioning_示例和注释">5.10.2. Provisioning 示例和注释</h4>
<div class="paragraph">
<p>测试新的 <em>ReST</em> 接口一种方法是使用 <code>provision.pl</code>。
运行它会得到一个输出摘要，但不完全清楚它是如何工作的。</p>
</div>
<div class="paragraph">
<p>下面是使用 <em>ReST</em> 接口添加新设备的示例：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash"># add a new foreign source called ubr
/usr/share/opennms/bin/provision.pl requisition add ubr
/usr/share/opennms/bin/provision.pl node add ubr 10341111 clownbox
/usr/share/opennms/bin/provision.pl node set ubr 10341111 city clownville
/usr/share/opennms/bin/provision.pl node set ubr 10341111 building clown-town-hall
/usr/share/opennms/bin/provision.pl node set ubr 10341111 parent-foreign-id 1122114
/usr/share/opennms/bin/provision.pl interface add ubr 10341111 10.1.3.4

# this is like a commit.  No changes will take effect until you import a foreign source
/usr/share/opennms/bin/provision.pl requisition import ubr</code></pre>
</div>
</div>
<div class="paragraph">
<p>你可能需要指定管理员的 用户名/密码。像这样：</p>
</div>
<div class="literalblock">
<div class="content">
<pre>--username=admin --password=clownnms</pre>
</div>
</div>
<div class="paragraph">
<p>到命令行。</p>
</div>
</div>
<div class="sect3">
<h4 id="_debian_lenny_笔记">5.10.3. Debian (Lenny) 笔记</h4>
<div class="paragraph">
<p>对于 Lenny 来说，你需要安装一个包来保证正常工作。
依据 <a href="http://backports.org/dokuwiki/doku.php?id=instructions" class="bare">http://backports.org/dokuwiki/doku.php?id=instructions</a> 说明将其添加到 <code>sources.list</code>。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash"># install liburi-perl from backports
sudo apt-get -t lenny-backports install liburi-perl</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_windows_powershell_rest">5.10.4. Windows Powershell ReST</h4>
<div class="paragraph">
<p>使用 <em>Windows Powershell</em> 通过 <em>ReST</em> 来填充一些资产字段的例子。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-powershell" data-lang="powershell"># Installdate of Windows
$wmi = Get-WmiObject -Class Win32_OperatingSystem
$dateInstalled = $wmi.ConvertToDateTime($wmi.InstallDate)

# Serialnumber and manufacturer of server
Get-WmiObject win32_bios | select SerialNumber
$wmi = Get-WmiObject -Class win32_bios
$manufacturer = $wmi.Manufacturer

# Text file with a description of the server for the comments field
$comment = Get-Content "C:\Program Files\BGInfo\Info_Description.txt" | Out-String

$user ="admin"
$pass= "admin"

$secpasswd = ConvertTo-SecureString $user -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential ($pass, $secpasswd)

$nodeid = Invoke-RestMethod -Uri http://opennms.domain.nl:8980/opennms/rest/nodes?label=servername.domain.nl -Credential $cred
$nodeid = $nodeid.nodes.node.id

$uri="http://opennms.domain.nl:8980/opennms/rest/nodes/$nodeid/assetRecord"

Invoke-RestMethod -Uri "http://opennms.massxess.nl:8980/opennms/rest/nodes/$nodeid/assetRecord/?building=133" -Credential $cred -Method PUT
Invoke-RestMethod -Uri "$uri/?manufacturer=$manufacturer" -Credential $cred -Method PUT
Invoke-RestMethod -Uri "$uri/?dateInstalled=$dateInstalled" -Credential $cred -Method PUT
Invoke-RestMethod -Uri "$uri/?comment=$comment" -Credential $cred -Method PUT</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_develop_documentation">6. Develop Documentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is the guideline for people who wish to contribute to writing documentation for the OpenNMS project.
The OpenNMS software is free and open source, contribution of any kind is welcome.
We ask that you observe the rules and guidelines outlined here to maintain consistency across the project.</p>
</div>
<div class="paragraph">
<p>Each (sub)project is represented as a section of the documentation.
Each section will produce a HTML output in the file system that is generated in the <code>target/generated</code> sources folder.</p>
</div>
<div class="paragraph">
<p>The chosen file format for documentation is AsciiDoc (<a href="http://www.methods.co.nz/asciidoc">Asciidoc Homepage</a>).
Document files use the <code>.adoc</code> file extension.</p>
</div>
<div class="paragraph">
<p>Note that there are different ways to contribute documentation, each suitable for the different use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tutorials and How To&#8217;s should be published on the <a href="http://wiki.opennms.org">OpenNMS Wiki</a>.
For example:
you want to describe how to use the Net-SNMP agent and the SNMP monitor from OpenNMS to solve a special use case with OpenNMS.</p>
</li>
<li>
<p>The documentation in the source code should be formal technical documentation.
The writing style should be accurate and concise.
However, ensure that you explain concepts in detail and do not make omissions.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="gd-docs-file-structure">6.1. File Structure in opennms-doc</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em><code>guide-admin/</code></em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module with the guide for administrators configuring, optimizing and running OpenNMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em><code>guide-development/</code></em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module with the guide for those who want to develop OpenNMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em><code>guide-install/</code></em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module with the guide of how to install OpenNMS on different operating systems</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em><code>releasenotes/</code></em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">module with the changelog and release notes</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="gd-docs-writing">6.2. Writing</h3>
<div class="paragraph">
<p>The following rules will help you to commit correctly formatted and prepared documentation for inclusion in the OpenNMS project.
It is important that we maintain a level of consistency across all of our committers and the documentation they produce.</p>
</div>
<div class="paragraph">
<p>When writing place a single sentence on each line.
This makes it easy to move content around, and also easy to spot long, or fragmented, sentences.
This will also allow us to assign comments on a sentence in GitHub which will facilitate easier merging.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Other than writing documentation, you can help out by providing comments on documentation, reviewing, suggesting improvements or reporting bugs.
To do this head over to: <a href="http://issues.opennms.org/browse/NMS/component/10011">issue tracker for documentation</a>!
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="gd-docs-conventions">6.2.1. Conventions for text formatting</h4>
<div class="paragraph">
<p>The following conventions are used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File names and path are written in `poller-configuration.xml` they will be rendered in: <code>poller-configuration.xml</code>;</p>
</li>
<li>
<p>Names that indicate special attention, e.g. this configuration matches *any* entry: this is rendered as: this configuration matches <strong>any</strong> entry;</p>
</li>
<li>
<p>_Italics_ is rendered as <em>Italics</em> and used for emphasis and indicate internal names and abbreviations;</p>
</li>
<li>
<p>*Bold* is rendered as <strong>Bold</strong> and should be used sparingly, for strong emphasis only;</p>
</li>
<li>
<p>+methodName()+ is rendered as methodName() and is also used for literals,
(note: the content between the <code>+</code> signs <em>will</em> be parsed);</p>
</li>
<li>
<p>`command` is rendered as <code>command</code> (typically used for command-line or parts used in configuration files),
(note: the content between the ` signs <em>will not</em> be parsed);</p>
</li>
<li>
<p>`my/path/` is rendered as <code>my/path/</code> this is used for file names and paths;</p>
</li>
<li>
<p>\``double quote'' (which is two grave accents to the left and two acute accents to the right) renders as ``double quote'';</p>
</li>
<li>
<p>\`single quote' (which is a single grave accent to the left and a single acute accent to the right) renders as `single quote'.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="gd-docs-gotchas">6.2.2. Gotchas</h4>
<div class="ulist">
<ul>
<li>
<p>Always leave a blank line at the top of the documents section.
It might be the title ends up in the last paragraph of the document;</p>
</li>
<li>
<p>Start in line 2 setting a relative path to the images directory to picture rendering on GitHub:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>// Allow image rendering
:imagesdir: relative/path/to/images/dir</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Always leave a blank line at the end of documents;</p>
</li>
<li>
<p>As {} are used for Asciidoc attributes, everything inside will be treated as an attribute.
To avoid this you have to escape the opening brace: \\{.
If you do not escape the opening brace, the braces and the text inside them will be removed without any warning being issued!;</p>
</li>
<li>
<p>Forcing line breaks can be achieved with ` +` at the end of the line followed by a line break.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example in source force line break</div>
<div class="content">
<pre class="prettyprint highlight"><code>This is the first line +
and this a forced 2nd line</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Rendered output with forced line break</div>
<p>This is the first line<br>
and this a forced 2nd line</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-structure">6.3. Headings and document structure</h3>
<div class="paragraph">
<p>Each document starts over with headings from level zero (the document title).
Each document should have an id.
In some cases sections in the document need to have id&#8217;s as well, this depends on where they fit in the overall structure.
If you wish to have a link to specific content that content has to have an id.
A missing id in a mandatory place will cause the build to fail.</p>
</div>
<div class="paragraph">
<p>To start a document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>[[unique-id-verbose-is-ok]]
= The Document Title</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are including the document inside another document and you need to push the headings down to the right level in the output, the leveloffset attribute is used.</p>
</div>
<div class="paragraph">
<p>Subsequent headings in a document should use the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>== Subheading

... content here ...

=== Subsubheading

content here ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="doc-guidelines-links">6.4. Links</h3>
<div class="paragraph">
<p>When you need to link to other parts of the manual you use the target id.
To use a target id you follow this syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>&lt;&lt;doc-guidelines-links&gt;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will render as: <a href="#doc-guidelines-links">Links</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To use the target id in you document simply write the target id in your text, for example:
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>see &lt;&lt;target-id&gt;&gt;</p>
</div>
<div class="paragraph">
<p>this should suffice for most cases.</p>
</div>
<div class="paragraph">
<p>If you need to link to another document with your own link text, then follow this procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>&lt;&lt;target-id, link text that fits in the context&gt;&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Having lots of linked text may work well in a web context but is a distracting in print.
      The documentation we are creating is intended for both mediums so be considerate of this in your usage.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you wish to use an external link, they are are added as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>http://www.opennms.org/[Link text here]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will render in the output as: <a href="http://www.opennms.org/">Link text here</a></p>
</div>
<div class="paragraph">
<p>For short links it may be beneficial not to use accompanying link text:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>http://www.opennms.org/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which renders as: <a href="http://www.opennms.org/" class="bare">http://www.opennms.org/</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is acceptable to have a period trailing after the URL, it will not render as a part of the link.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="doc-guideline-admonitions-notes">6.5. Admonitions and useful notes</h3>
<div class="paragraph">
<p>These are useful for defining specific sections, such as Notes, Tips and Important information.
We encourage the use of them in the documentation as long as they are used appropriately.
Choose from the following:</p>
</div>
<div class="listingblock">
<div class="title">Source template for making a note for additional hints</div>
<div class="content">
<pre class="prettyprint highlight"><code>NOTE: This is my note.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how its rendered:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is my note.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Source for giving a tip</div>
<div class="content">
<pre class="prettyprint highlight"><code>TIP: This is my tip.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how its rendered:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This is my tip.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Source for giving a important hint</div>
<div class="content">
<pre class="prettyprint highlight"><code>IMPORTANT: This is my important hint.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how its rendered:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is my important hint.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Source for giving a caution</div>
<div class="content">
<pre class="prettyprint highlight"><code>CAUTION: This is my caution.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how its rendered:</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
This is my caution.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Source for giving a warning</div>
<div class="content">
<pre class="prettyprint highlight"><code>WARNING: This is my warning.</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is how its rendered:</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is my warning.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A multiline variation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>TIP: Tiptext. +
     Line 2.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which is rendered as:</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Tiptext.<br>
     Line 2.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember to write these in full caps. There is no easy manner in which to add new admonitions, do not create your own.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-attributes">6.6. Attributes</h3>
<div class="paragraph">
<p>Common attributes you can use in documents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{opennms-version} - rendered as "23.0.1"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These can substitute part of URLs that point to, for example, APIdocs or source code.
Note that opennms-git-tag also handles the case of snapshot/master.</p>
</div>
<div class="paragraph">
<p>Sample Asciidoc attributes which can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{docdir} - root directory of the documents</p>
</li>
<li>
<p>{nbsp} - non-breaking space</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-comments">6.7. Comments</h3>
<div class="paragraph">
<p>There&#8217;s a separate build that includes comments.
When the comments are used they show up with a yellow background.
This build doesn&#8217;t run by default, but after a normal build, you can use <code>make annotated</code> to create a build yourself.
You can use the resulting 'annotated' page to search for content as the full manual is a single page.</p>
</div>
<div class="paragraph">
<p>To write a comment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>// this is a comment</code></pre>
</div>
</div>
<div class="paragraph">
<p>Comments are not visible in the standard build.
Comment blocks won&#8217;t be included in the output of any build.
The syntax for a comment block is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>////
Note that includes in here will still be processed, but not make it into the output.
That is, missing includes here will still break the build!
////</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-tables">6.8. Tables</h3>
<div class="paragraph">
<p>For representing structured information you can use tables.
A table is constructed in the following manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>[options="header, autowidth"]
|===
| Parameter     | Description                | Required | Default value
| `myFirstParm` | my first long description  | required | `myDefault`
| `myScndParm`  | my second long description | required | `myDefault`
|===</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is rendered as:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myFirstParm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">my first long description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myDefault</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myScndParm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">my second long description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>myDefault</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please align your columns in the AsciiDoc source in order to give better readability when editing in text view.
      If you have a very long description, break at 120 characters and align the text to improve source readability.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docs/01_long-table-formatting.png" alt="01 long table formatting">
</div>
<div class="title">Figure 1. Example in AsciiDoc source for very long table descriptions</div>
</div>
<div class="paragraph">
<p>this is rendered as:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>basic-authentication</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication credentials to perform basic authentication.
                           Credentials should comply to <a href="http://www.rfc-editor.org/rfc/rfc1945.txt">RFC1945</a> section 11.1,
                           without the Base64 encoding part. That&#8217;s: be a string made of the concatenation of:<br>
                           1- the user ID;<br>
                           2- a colon;<br>
                           3- the password.<br>
                          <code>basic-authentication</code> takes precedence over the <code>user</code> and <code>password</code> parameters.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>header[0-9]+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional headers to be sent along with the request. Example of valid parameter&#8217;s names are
                           <code>header0</code>, <code>header1</code> and <code>header180</code>. <code>header</code> is <strong>not</strong> a valid parameter name.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="doc-guidelines-images">6.9. Include images</h3>
<div class="paragraph">
<p>When visualizing complex problems you can help the explanation and provide greater information by using an image.
We use in OpenNMS documentation modules two directories for images.</p>
</div>
<div class="paragraph">
<p>The image folder structure mirrors the text structure.
In this case it is a little bit easier to locate the AsciiDoc text file where the image is included.</p>
</div>
<div class="listingblock">
<div class="title">Example folder structure for image files</div>
<div class="content">
<pre class="prettyprint highlight"><code>.
└── opennms-doc<i class="conum" data-value="1"></i><b>(1)</b>
    └── guide-doc<i class="conum" data-value="2"></i><b>(2)</b>
        ├── README.adoc
        ├── pom.xml
        ├── src<i class="conum" data-value="3"></i><b>(3)</b>
        |   └── asciidoc<i class="conum" data-value="4"></i><b>(4)</b>
        |       ├── configs
        |       |   └── poller-configuration.xml
        |       ├── images<i class="conum" data-value="5"></i><b>(5)</b>
        |       |   ├── 01_opennms-logo.png<i class="conum" data-value="6"></i><b>(6)</b>
        |       |   └── 02_pris-overview.png
        |       ├── images_src<i class="conum" data-value="7"></i><b>(7)</b>
        |       |   └── pris-overview.graphml<i class="conum" data-value="8"></i><b>(8)</b>
        |       ├── index.adoc<i class="conum" data-value="9"></i><b>(9)</b>
        |       └── text
        |           ├── images.adoc<i class="conum" data-value="10"></i><b>(10)</b>
        |           ├── include-source.adoc
        |           ├── introduction.adoc
        |           └── writing.adoc
        └── target<i class="conum" data-value="11"></i><b>(11)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This folder contains all documentation modules;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The module for this documentation for target group of documentation contributors;</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Indicates a source folder;</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The documentation root folder;</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Folder for images. Images should be *.png or *.jpg if included in the documentation;</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The image used, the format is a leading <code>&lt;number&gt;_</code> followed by a name using no spaces;</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Some images are created from tools like <em>yED</em>, this folder should contain the editable version of the file with the same file name;</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Editable version of the image source file, note no spaces in the name;</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Main document file which includes all documentation parts and is rendered as <code>index.html</code> for the web;</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>AsciiDoc source file which can include images;</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Target folder with generated HTML output after <code>mvn clean package</code> has been performed;</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
All images in the entire manual share the same namespace, it is therefore best practice to use unique identifiers for images.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To include an image file, make sure that it resides in the 'images/' directory relative to the document you&#8217;re including it within.
Then use the following syntax for inclusion in the document:</p>
</div>
<div class="listingblock">
<div class="title">First included image</div>
<div class="content">
<pre class="prettyprint highlight"><code>.This is a caption of the image
image::docs/02_opennms-logo.png[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which is rendered as:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docs/02_opennms-logo.png" alt="02 opennms logo">
</div>
<div class="title">Figure 2. This is a caption of the image</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The image path for the images you include is relative to the *.adoc source file, where you use the image.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-include-source">6.10. Code Snippets</h3>
<div class="paragraph">
<p>You can include code snippets, configuration- or source code files in the documentation.
You can enable syntax highlighting by providing the given language parameter, this will work on source code or configuration.</p>
</div>
<div class="sect3">
<h4 id="gd-docs-explicit">6.10.1. Explicitly defined in the document</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
be careful to use this kind of code snippets as sparsely as possible.
Code becomes obsolete very quickly, archaic usage practices are detrimental.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>if you do wish to include snippets use the following method:</p>
</div>
<div class="listingblock">
<div class="title">This is a sample configuration explicitly in the documentation</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;service name="DNS" interval="300000" user-defined="false" status="on"&gt;
  &lt;parameter key="retry" value="2" /&gt;
  &lt;parameter key="timeout" value="5000" /&gt;
  &lt;parameter key="port" value="53" /&gt;
  &lt;parameter key="lookup" value="localhost" /&gt;
  &lt;parameter key="fatal-response-codes" value="2,3,5" /&gt;&lt;!-- ServFail, NXDomain, Refused --&gt;
  &lt;parameter key="rrd-repository" value="/opt/opennms/share/rrd/response" /&gt;
  &lt;parameter key="rrd-base-name" value="dns" /&gt;
  &lt;parameter key="ds-name" value="dns" /&gt;
&lt;/service&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there&#8217;s no suitable syntax highlighter for the code used just omit the language: [source].</p>
</div>
<div class="paragraph">
<p>Currently the following syntax highlighters are enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bash</p>
</li>
<li>
<p>Groovy</p>
</li>
<li>
<p>Java</p>
</li>
<li>
<p>JavaScript</p>
</li>
<li>
<p>Python</p>
</li>
<li>
<p>XML</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other highlighters that could be added see <a href="https://code.google.com/p/google-code-prettify/" class="bare">https://code.google.com/p/google-code-prettify/</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="gd-docs-include">6.10.2. Included from an example file</h4>
<div class="paragraph">
<p>You can include source or configuration from an external file.
In this way you can provide a working example configuration maintaining doc and example at the same time.
The procedure and rules are the same as with images, the path is relative to the *.adoc file where the file to be used is included.</p>
</div>
<div class="literalblock">
<div class="title">Include complete external file</div>
<div class="content">
<pre>[source,xml]
----
include::../configs/wmi-config.xml[]
----</pre>
</div>
</div>
<div class="paragraph">
<p>This is how it&#8217;s rendered:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0"?&gt;
&lt;wmi-config retry="2" timeout="1500"
	username="Administrator" domain="WORKGROUP" password="password"&gt;
&lt;/wmi-config&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gd-docs-include-parts">6.10.3. Include parts of a file</h4>
<div class="paragraph">
<p>If you want to include just a specific segment of a large configuration file, you can assign tags that indicate to AsciiDoc the section that is to be included.
In this example just the service definition of the <em>ICMP monitor</em> should be included.</p>
</div>
<div class="paragraph">
<p>In the 'poller-configuration.xml' tag the section in the following manner:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">...
&lt;rrd step="300"&gt;
  &lt;rra&gt;RRA:AVERAGE:0.5:1:2016&lt;/rra&gt;
  &lt;rra&gt;RRA:AVERAGE:0.5:12:1488&lt;/rra&gt;
  &lt;rra&gt;RRA:AVERAGE:0.5:288:366&lt;/rra&gt;
  &lt;rra&gt;RRA:MAX:0.5:288:366&lt;/rra&gt;
  &lt;rra&gt;RRA:MIN:0.5:288:366&lt;/rra&gt;
&lt;/rrd&gt;
&lt;!-- # tag::IcmpServiceConfig[] --&gt;
&lt;service name="ICMP" interval="300000" user-defined="false" status="on"&gt;
  &lt;parameter key="retry" value="2" /&gt;
  &lt;parameter key="timeout" value="3000" /&gt;
  &lt;parameter key="rrd-repository" value="/opt/opennms/share/rrd/response" /&gt;
  &lt;parameter key="rrd-base-name" value="icmp" /&gt;
  &lt;parameter key="ds-name" value="icmp" /&gt;
&lt;/service&gt;
&lt;!-- # end::IcmpServiceConfig[] --&gt;
&lt;service name="DNS" interval="300000" user-defined="false" status="on"&gt;
  &lt;parameter key="retry" value="2" /&gt;
  &lt;parameter key="timeout" value="5000" /&gt;
  &lt;parameter key="port" value="53" /&gt;
...</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Include this tagged part in the documentation using the <em>tag</em> parameter</div>
<div class="content">
<pre>[source,xml]
----
include::../configs/poller-configuration.xml[tags=IcmpServiceConfig]
----</pre>
</div>
</div>
<div class="listingblock">
<div class="title">This is how it rendered</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;service name="ICMP" interval="300000" user-defined="false" status="on"&gt;
      &lt;parameter key="retry" value="2" /&gt;
      &lt;parameter key="timeout" value="3000" /&gt;
      &lt;parameter key="rrd-repository" value="/opt/opennms/share/rrd/response" /&gt;
      &lt;parameter key="rrd-base-name" value="icmp" /&gt;
      &lt;parameter key="ds-name" value="icmp" /&gt;
    &lt;/service&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spaces and tabs are taken from the original file.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="doc-guidelines-cheat-sheets">6.11. Cheat Sheets and additional hints</h3>
<div class="paragraph">
<p>The documentation uses the AsciiDoc format.
There are a number of guides that will help you to get started with using AsciiDoc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.microjaja.com/docs/asciidoc-writers-guide.pdf">AsciiDoc Writers Guide</a></p>
</li>
<li>
<p><a href="http://www.methods.co.nz/asciidoc/">Aciidoc Reference</a></p>
</li>
<li>
<p><a href="http://www.methods.co.nz/asciidoc/faq.html">AsciiDoc FAQ</a></p>
</li>
<li>
<p><a href="http://powerman.name/doc/asciidoc">Powerman AsciiDoc Cheatsheet</a></p>
</li>
<li>
<p><a href="http://xpt.sourceforge.net/techdocs/nix/tool/asciidoc-syn/ascs01-AsciiDocMarkupSyntaxQuickSummary/single/">XPT AsciiDoc Cheatsheet</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other resources, to gain familiarity with AsciiDoc, you can visit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://asciidoctor.org/docs/user-manual">AsciiDoc User Manual</a></p>
</li>
<li>
<p><a href="http://asciidoctor.org/docs/install-and-use-asciidoctor-maven-plugin/">AsciiDoc Maven Plugin</a></p>
</li>
<li>
<p><a href="https://groups.google.com/forum/?fromgroups#!forum/asciidoc">AsciiDoc discussion list</a></p>
</li>
<li>
<p><a href="http://code.google.com/p/asciidoc/issues/list">AsciiDoc issue tracker</a></p>
</li>
<li>
<p><a href="https://github.com/oreillymedia/docbook2asciidoc">Docbook to AsciiDoc</a></p>
</li>
<li>
<p><a href="http://blog.rainwebs.net/2010/02/25/how-to-create-handsome-pdf-documents-without-frustration/">How to create handsome PDF documents without frustration</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="gd-docs-migrating-from-wiki">6.12. Migrating content from project wiki</h3>
<div class="paragraph">
<p>The <a href="https://wiki.opennms.org">project wiki</a> contains much information that ought to be migrated to the official documentation set.
To help with this effort, we have a wiki template which informs readers of articles that are tagged for migration to the official docs, or that have already been migrated.
When you identify an article in the OpenNMS wiki whose information should be migrated (either in its entirety, or just individual sections), use the following process.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you do not already have a wiki account, <a href="https://wiki.opennms.org/wiki/Special:RequestAccount">request one</a> before getting started. Your request must be approved by a wiki admin. If you don&#8217;t get approved within a day, send a note to the <a href="https://sourceforge.net/projects/opennms/lists/opennms-devel">opennms-devel mailing list</a> or on the <a href="https://chat.opennms.com/opennms/channels/opennms-development"><strong>OpenNMS Development</strong> chat channel</a>.</p>
</li>
<li>
<p>Create an issue in the <a href="https://issues.opennms.org/projects/NMS/">project issue tracker, in project <strong>NMS</strong></a>. Note the issue number; you will use it below.</p>
</li>
<li>
<p>After logging in to the wiki, visit the article whose content should be migrated.</p>
</li>
<li>
<p>Click on the <strong>Edit Source</strong> link at the top of the article view.</p>
</li>
<li>
<p>Add text like the following to the top of the article source editor:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>{{OfficialDocs | scope=article | guide=admin | issue=NMS-9926 | date=March 2018 | completed=false}}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The value of the <code>scope</code> attribute must be either <code>article</code>, if the entire article should be migrated,or <code>section</code> if only specific section(s) should be migrated.</p>
<div class="ulist">
<ul>
<li>
<p>When using <code>scope = section</code>, it&#8217;s fine to use this template multiple times in a single article.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The value of the <code>guide</code> attribute must be one of <code>admin</code>, <code>development</code>, <code>install</code>, or <code>user</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If the information in an article should be migrated to multiple official guides, use multiple instances of the <code>{{OfficialDocs}}</code> template; try to target these by section when possible.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The value of the <code>issue</code> parameter must be a valid issue ID in the <a href="https://issues.opennms.org">project issue tracker</a>, and will become a live link</p>
</li>
<li>
<p>The value of the <code>date</code> parameter should be the month and year when the tag was added, <strong>e.g.</strong> <code>March 2018</code>.</p>
</li>
<li>
<p>The <code>completed</code> parameter is optional; it is assumed to be false if omitted, or true if its value is either <code>true</code> or <code>yes</code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docs/03_officialdocs-wiki-template-source.png" alt="03 officialdocs wiki template source">
</div>
<div class="title">Figure 3. Wiki source editor with example <code>OfficialDocs</code> template usage</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Enter an edit summary such as <strong>Tagged for migration to official docs, NMS-12345</strong> and click <strong>Show preview</strong></p>
</li>
<li>
<p>After verifying that your changes render as expected (see image), click <strong>Save changes</strong>.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docs/04_officialdocs-wiki-template-rendered-pending.png" alt="04 officialdocs wiki template rendered pending">
</div>
<div class="title">Figure 4. Rendering of <code>OfficialDocs</code> wiki template on an article pending migration</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Migrate the information, making sure to follow the guidelines laid out earlier in this section; do not just copy and paste, and watch out for obsolete information. If you need help, contact the developers through one of the methods mentioned above.</p>
</li>
<li>
<p>Once the migration is complete and the issue is closed, edit the wiki article again and change <code>completed=false</code> to <code>completed=true</code>.</p>
</li>
<li>
<p>The rendering of the template will change to indicate that the migration has been completed.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/docs/04_officialdocs-wiki-template-rendered-completed.png" alt="04 officialdocs wiki template rendered completed">
</div>
<div class="title">Figure 5. Rendering of <code>OfficialDocs</code> wiki template on an article whose migration is completed</div>
</div>
<div class="paragraph">
<p>Adding the <code>{{OfficialDocs}}</code> template to an article will implicitly add that article to a pair of wiki categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Migration to official docs pending</strong> or <strong>Migration to official docs completed</strong>, according to the value of the <code>completed</code> attribute</p>
</li>
<li>
<p><strong>Migrate to <code>X</code> guide</strong>, according to the value of the <code>guide</code> attribute</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_amqp_integration">7. AMQP Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AMQP Integration allows external systems to communicate with the event bus of OpenNMS Horizon and receive alarms via the AMQP protocol.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>AMQP</em> is standard messaging protocol supported by a number of brokers including <em>ActiveMQ</em> and <em>QPID</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The integration is written using Camel + OSGi and has the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Event Forwarder</p>
</li>
<li>
<p>Event Receiver</p>
</li>
<li>
<p>Alarm Northbounder</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Custom filtering (i.e. which events to forward) and transformations (i.e. how the events are represented in the messages) can be used in each of the components.
Generic implementations</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each componenent can be configured and setup independently, i.e. you can choose to only forward alarms.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_event_forwarder">7.1. Event Forwarder</h3>
<div class="paragraph">
<p>The event forwarder listens for <em>all</em> events on the internal event bus of OpenNMS Horizon.
Events from the bus are sent to a Camel processor, which can filter or transform these, before being sent to the AMQP endpoint.</p>
</div>
<div class="paragraph">
<p>The event forwarder exposes the following properties via the <code>org.opennms.features.amqp.eventforwarder</code> pid:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connectionUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp://localhost:5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the JmsConnectionFactory. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp:topic:opennms-events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target queue or topic. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processorName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-event-forwarder-processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Named <code>org.apache.camel.Processor</code> implementation used to filter and/or format the events.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The default processor, the <code>default-event-forwarder-processor</code>, marshalls events to XML and does not perform any filtering.
This means that when enabled, all events will be forwarded to the AMQP destination with XML strings as the message body.</p>
</div>
<div class="sect3">
<h4 id="_setup">7.1.1. Setup</h4>
<div class="paragraph">
<p>Start by logging into a Karaf shell.</p>
</div>
<div class="paragraph">
<p>Update the properties with your deployment specific values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>config:edit org.opennms.features.amqp.eventforwarder
config:property-set connectionUrl amqp://localhost:5672
config:property-set destination amqp:topic:opennms-events
config:property-set processorName default-event-forwarder-processor
config:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install the feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>feature:install opennms-amqp-event-forwarder</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_debugging">7.1.2. Debugging</h4>
<div class="paragraph">
<p>You can get detailed information on the Camel route using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>camel:route-info forwardEvent</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_event_receiver">7.2. Event Receiver</h3>
<div class="paragraph">
<p>The event receiver listens for messages from an AMQP target and forwards them onto the internal event bus of OpenNMS Horizon.
Messages are sent to a Camel processor, which can filter or transform these, before being sent onto the event bus.</p>
</div>
<div class="paragraph">
<p>The event receiver exposes the following properties via the <code>org.opennms.features.amqp.eventreceiver</code> pid:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connectionUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp://localhost:5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the JmsConnectionFactory. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp:queue:opennms-events</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source queue or topic. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processorName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-event-receiver-processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Named <code>org.apache.camel.Processor</code> implementation used to filter and/or format the events.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The default processor, the <code>default-event-receiver-processor</code>, expects the message bodies to contain XML strings which are it unmarshalls to events.</p>
</div>
<div class="sect3">
<h4 id="_setup_2">7.2.1. Setup</h4>
<div class="paragraph">
<p>Start by logging into a Karaf shell.</p>
</div>
<div class="paragraph">
<p>Update the properties with your deployment specific values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>config:edit org.opennms.features.amqp.eventreceiver
config:property-set connectionUrl amqp://localhost:5672
config:property-set source amqp:queue:opennms-events
config:property-set processorName default-event-receiver-processor
config:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install the feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>feature:install opennms-amqp-event-receiver</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_debugging_2">7.2.2. Debugging</h4>
<div class="paragraph">
<p>You can get detailed information on the Camel route using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>camel:route-info receiveEvent</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_alarm_northbounder">7.3. Alarm Northbounder</h3>
<div class="paragraph">
<p>The alarm northbounder listens for <em>all</em> northbound alarms.
Alarms are sent to a Camel processor, which can filter or transform these, before being sent to the AMQP endpoint.</p>
</div>
<div class="paragraph">
<p>The alarm northbounder exposes the following properties via the <code>org.opennms.features.amqp.alarmnorthbounder</code> pid:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connectionUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp://localhost:5672</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the JmsConnectionFactory. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">guest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">amqp:topic:opennms-alarms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target queue or topic. See <a href="http://camel.apache.org/amqp.html">AMQP</a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">processorName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-alarm-northbounder-processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Named <code>org.apache.camel.Processor</code> implementation used to filter and/or format the alarms.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The default processor, the <code>default-alarm-northbounder-processor</code>, converts the alarms to a string and does not perform any filtering.
This means that when enabled, all alarms will be forwarded to the AMQP destination with strings as the message body.</p>
</div>
<div class="sect3">
<h4 id="_setup_3">7.3.1. Setup</h4>
<div class="paragraph">
<p>Start by logging into a Karaf shell.</p>
</div>
<div class="paragraph">
<p>Update the properties with your deployment specific values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>config:edit org.opennms.features.amqp.alarmnorthbounder
config:property-set connectionUrl amqp://localhost:5672
config:property-set destination amqp:topic:opennms-alarms
config:property-set processorName default-alarm-northbounder-processor
config:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install the feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>feature:install opennms-amqp-alarm-northbounder</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_debugging_3">7.3.2. Debugging</h4>
<div class="paragraph">
<p>You can get detailed information on the Camel route using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>camel:route-info forwardAlarm</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_processors">7.4. Custom Processors</h3>
<div class="paragraph">
<p>If your integration requires specific filtering and or formatting, you can write your own processor by implementing the <code>org.apache.camel.Processor</code> interface.</p>
</div>
<div class="paragraph">
<p>For example, we can implement a custom processor used for event forwarding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import org.apache.camel.Exchange;
import org.apache.camel.Processor;

public class MyEventProcessor implements Processor {
    @Override
    public void process(final Exchange exchange) throws Exception {
        final Event event = exchange.getIn().getBody(Event.class);

        // Filtering
        if (!shouldForward(event)) {
            exchange.setProperty(Exchange.ROUTE_STOP, Boolean.TRUE);
            return;
        }

        // Transforming
        MyDTO eventAsDTO = toDTO(event);
        exchange.getIn().setBody(eventAsDTO, MyDTO.class);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to use the processor, package it as a bundle, and expose it to the OSGi service registry using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">&lt;bean id="myEventProcessor" class="org.opennms.integrations.evilcorp.MyEventProcessor" /&gt;

&lt;service id="myEventProcessorService" ref="myEventProcessor" interface="org.apache.camel.Processor"&gt;
  &lt;service-properties&gt;
    &lt;entry key="name" value="evilcorp-event-forwarder-processor"/&gt;
  &lt;/service-properties&gt;
&lt;/service&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once your bundle in the Karaf container, you can update the loaded you can refer to your processor with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>config:edit org.opennms.features.amqp.eventforwarder
config:property-set processorName evilcorp-event-forwarder-processor
config:update</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the event forwarder feature was already started, it should automatically restart and start using the new processor.
Otherwise, you can start the feature with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>feature:install opennms-amqp-event-forwarder</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_and_styleguidelines">8. Design and Styleguidelines</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_jasper_report_guideline">8.1. Jasper Report Guideline</h3>
<div class="paragraph">
<p>Building and contributing JasperReports is a way to contribute to the project.
To make it easier to maintain and style reports the following layout guideline can be used to have similar and more consistent report layout.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/reporting/01_JasperReportStyleGuide.png" alt="01 JasperReportStyleGuide">
</div>
<div class="title">Figure 6. Layout for creating JasperReports</div>
</div>
<div class="paragraph">
<p>The following formatting can be applied:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Convention</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Date</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy/MM/dd HH:mm:ss</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Report Range</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Report Begin: ${startDate} Report End: ${endDate}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Paging</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Page ${current} of ${total}</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Based on this template definition there exist a <a href="https://github.com/opennms-forge/jasper-template">GitHub repository</a> which contains a JasperReport template.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 OpenNMS Horizon 23.0.1<br>
Last updated 2018-12-16 09:22:49 CST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>